<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maquette</title>

  <!-- Google Fonts selon le Design Brief -->
  <link href="https://fonts.googleapis.com/css2?family=Quattrocento:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet CSS (pour cartes si n√©cessaire) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

    /* Polices du Design Brief */
    .font-display { font-family: 'Quattrocento', serif; }
    .font-body { font-family: 'Quattrocento', sans-serif; }

    /* Appliquer la police body par d√©faut */
    body { font-family: 'Quattrocento', sans-serif; }

    /* Animation de base pour les entr√©es */
    @keyframes fade-in-up {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in-up {
      animation: fade-in-up 0.5s ease-out forwards;
      opacity: 0;
    }

    /* Animation de fade simple */
    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .animate-fade-in {
      animation: fade-in 0.3s ease-out forwards;
    }

    /* Animation scale */

    /* Header hover states */
    header:hover {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    /* Mobile menu button */
    .menu-button {
      position: relative;
      overflow: hidden;
      background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
      border: 1px solid rgba(0, 0, 0, 0.06);
    }

    .menu-button::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .menu-button:hover {
      background: linear-gradient(135deg, #e5e7eb, #d1d5db);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .menu-button:active::after {
      opacity: 1;
    }

    .menu-button:active {
      transform: translateY(0);
    }

    /* Header sp√©cifique am√©liorations */
    header {
      backdrop-filter: blur(16px);
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.95));
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04);
      position: sticky;
      top: 0;
      z-index: 50;
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    }

    /* Header inner container animations */
    header > div {
      transition: padding 0.3s ease;
    }

    /* Logo container styles */
    .logo-container {
      position: relative;
      display: inline-block;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .logo-container:hover {
      transform: scale(1.05);
    }

    /* Logo hover effect */
    .logo-glow {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .logo-glow:hover {
      filter: drop-shadow(0 4px 12px rgba(59, 130, 246, 0.25));
      border-color: rgba(59, 130, 246, 0.2);
      box-shadow: 0 4px 16px rgba(59, 130, 246, 0.15);
      border-color: rgba(59, 130, 246, 0.1);
    }

    /* Header text styles */
    header h1 {
      letter-spacing: -0.025em;
      text-rendering: optimizeLegibility;
      font-weight: 800;
    }

    /* Badge styles for tagline */
    .header-tagline {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: white;
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 0.675rem;
      letter-spacing: 0.1em;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(251, 191, 36, 0.2);
      position: relative;
      overflow: hidden;
    }

    .header-tagline::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }

    .header-tagline:hover::before {
      transform: translateX(100%);
    }

    /* Status indicator with pulse */
    .status-indicator {
      position: relative;
    }

    .status-indicator::before {
      content: '';
      position: absolute;
      inset: -4px;
      background: rgba(34, 197, 94, 0.2);
      border-radius: 50%;
      animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse-ring {
      0% { transform: scale(1); opacity: 1; }
      75%, 100% { transform: scale(1.5); opacity: 0; }
    }

    /* Profile button hover effects */
    .group:hover .w-9 {
      transform: scale(1.05);
      box-shadow: 0 8px 16px rgba(59, 130, 246, 0.3);
    }

    /* Notification dot animation */
    @keyframes notification-pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.8; }
    }

    /* Header scroll effect */
    header.scrolled {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      backdrop-filter: blur(20px);
    }

    /* Quick action buttons hover */
    button svg {
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    button:hover svg {
      transform: translateY(-1px);
    }

    /* Header badge shine effect */
    @keyframes badge-shine {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }

    .header-tagline {
      background-size: 200% 100%;
      animation: badge-shine 3s linear infinite;
    }

    /* Responsive header adjustments */
    @media (max-width: 640px) {
      .header-tagline {
        display: none;
      }

      .logo-container img {
        height: 2.5rem;
        width: 2.5rem;
      }

      header h1 {
        font-size: 1.25rem;
      }
    }

    @media (min-width: 1024px) {
      header:hover {
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      }
    }
    @keyframes scale-in {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    /* Profondeur pour l'inventaire */
    .inventory-card {
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      transform-style: preserve-3d;
    }

    .inventory-card::before {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 12px;
      right: 12px;
      height: 20px;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1), transparent);
      border-radius: 50%;
      filter: blur(8px);
      z-index: -1;
      transition: all 0.3s ease;
    }

    .inventory-card:hover::before {
      bottom: -12px;
      left: 8px;
      right: 8px;
      filter: blur(12px);
    }

    .inventory-stat-card {
      position: relative;
      background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
      border: 1px solid rgba(209, 213, 219, 0.8);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: all 0.3s ease;
    }

    .inventory-stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    .inventory-table-row {
      transition: all 0.2s ease;
      position: relative;
    }

    .inventory-table-row:hover {
      background-color: rgba(243, 244, 246, 0.8);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      transform: scale(1.01);
    }

    .inventory-modal-backdrop {
      backdrop-filter: blur(8px) saturate(1.2);
    }

    .inventory-badge {
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .inventory-icon-container {
      position: relative;
      perspective: 1000px;
    }

    .inventory-icon-container::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      height: 8px;
      background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.15) 0%, transparent 70%);
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .inventory-card:hover .inventory-icon-container::after {
      opacity: 1;
    }
    .animate-scale-in {
      animation: scale-in 0.3s ease-out forwards;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- CHARGEMENT S√âQUENTIEL DES CDN - NE PAS MODIFIER -->
  <script>
    (function() {
      var scripts = [
        'https://unpkg.com/react@18/umd/react.production.min.js',
        'https://unpkg.com/react-dom@18/umd/react-dom.production.min.js',
        'https://unpkg.com/prop-types@15/prop-types.min.js',
        'https://unpkg.com/recharts@2.12.7/umd/Recharts.js',
        'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js',
        'https://unpkg.com/@babel/standalone/babel.min.js'
      ];
      var index = 0;
      function loadNext() {
        if (index >= scripts.length) {
          if (typeof Babel !== 'undefined' && Babel.transformScriptTags) {
            Babel.transformScriptTags();
          }
          return;
        }
        var script = document.createElement('script');
        script.src = scripts[index];
        script.onload = function() { index++; loadNext(); };
        script.onerror = function() { console.error('Erreur CDN: ' + scripts[index]); };
        document.body.appendChild(script);
      }
      loadNext();
    })();
  </script>

  <script type="text/babel">
    // OBLIGATOIRE: Destructurer Recharts (NE PAS SUPPRIMER)
    const { LineChart, Line, BarChart, Bar, PieChart, Pie, Cell, AreaChart, Area,
            XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

    // ============================================================
    // APPLICATION DE GESTION TRAITEUR - LE BANGARD INC.
    // ============================================================

    // Donn√©es mock√©es r√©alistes pour le Qu√©bec
    const mockData = {
      clients: [
        { id: 1, nom: "Jean Tremblay", entreprise: "Restaurant Chez Marcel", email: "jean@chezmarcel.ca", telephone: "(514) 555-1234", type: "B2B", credit: 10000, balance: 2450, dernierCommande: "2024-02-02" },
        { id: 2, nom: "Marie Lavoie", entreprise: "√âpicerie Lavoie & Fils", email: "marie@epicerielavoie.ca", telephone: "(514) 555-5678", type: "B2B", credit: 15000, balance: 0, dernierCommande: "2024-02-03" },
        { id: 3, nom: "Pierre Gagnon", entreprise: "Traiteur Gagnon", email: "pierre@traiteurgagnon.ca", telephone: "(450) 555-9012", type: "B2B", credit: 20000, balance: 5600, dernierCommande: "2024-01-28" },
        { id: 4, nom: "Sophie Bouchard", entreprise: "Caf√© Sophie", email: "sophie@cafesophie.ca", telephone: "(514) 555-3456", type: "B2B", credit: 8000, balance: 1200, dernierCommande: "2024-02-01" },
        { id: 5, nom: "Martin Roy", entreprise: "Boulangerie Roy", email: "martin@boulangerieroy.ca", telephone: "(438) 555-7890", type: "B2B", credit: 12000, balance: 0, dernierCommande: "2024-01-30" }
      ],

      commandes: [
        { id: 1, clientId: 1, numero: "CMD-2024-001", date: "2024-02-02", statut: "En pr√©paration", montant: 2450, items: 12, livraison: "2024-02-05 10:00" },
        { id: 2, clientId: 2, numero: "CMD-2024-002", date: "2024-02-03", statut: "Confirm√©e", montant: 1890, items: 8, livraison: "2024-02-06 14:00" },
        { id: 3, clientId: 1, numero: "CMD-2024-003", date: "2024-02-01", statut: "Livr√©e", montant: 3200, items: 15, livraison: "2024-02-01 12:00" },
        { id: 4, clientId: 3, numero: "CMD-2024-004", date: "2024-01-28", statut: "Livr√©e", montant: 5600, items: 25, livraison: "2024-01-28 18:00" },
        { id: 5, clientId: 4, numero: "CMD-2024-005", date: "2024-02-01", statut: "En production", montant: 1200, items: 6, livraison: "2024-02-04 09:00" }
      ],

      produits: [
        { id: 1, nom: "Plateau de sandwichs vari√©s", sku: "PLT-001", categorie: "Plateaux", prix: 65, stock: 50, unite: "plateau", allergenes: ["Gluten", "≈íufs", "Moutarde"] },
        { id: 2, nom: "Salade C√©sar", sku: "SAL-001", categorie: "Salades", prix: 45, stock: 30, unite: "bol", allergenes: ["≈íufs", "Poisson", "Lait"] },
        { id: 3, nom: "Wrap v√©g√©tarien", sku: "WRP-001", categorie: "Wraps", prix: 8.50, stock: 100, unite: "unit√©", allergenes: ["Gluten", "Soja"] },
        { id: 4, nom: "Box √† lunch compl√®te", sku: "BOX-001", categorie: "Bo√Ætes", prix: 18.50, stock: 75, unite: "bo√Æte", allergenes: ["Variable"] },
        { id: 5, nom: "Plateau de fruits frais", sku: "PLT-002", categorie: "Plateaux", prix: 55, stock: 40, unite: "plateau", allergenes: [] }
      ],

      recettes: [
        { id: 1, nom: "Sandwich au poulet grill√©", rendement: 10, unite: "portions", coutMatiere: 3.25, tempsPrepMinutes: 15, allergenes: ["Gluten", "Moutarde"], categorie: "Sandwichs" },
        { id: 2, nom: "Salade C√©sar maison", rendement: 20, unite: "portions", coutMatiere: 2.15, tempsPrepMinutes: 20, allergenes: ["≈íufs", "Poisson", "Lait"], categorie: "Salades" },
        { id: 3, nom: "Wrap v√©g√©tarien deluxe", rendement: 15, unite: "unit√©s", coutMatiere: 2.80, tempsPrepMinutes: 25, allergenes: ["Gluten", "Soja"], categorie: "Wraps" },
        { id: 4, nom: "Mousse au chocolat", rendement: 30, unite: "portions", coutMatiere: 1.50, tempsPrepMinutes: 45, allergenes: ["Lait", "≈íufs"], categorie: "Desserts" },
        { id: 5, nom: "Soupe du jour", rendement: 5, unite: "litres", coutMatiere: 8.00, tempsPrepMinutes: 60, allergenes: ["Variable"], categorie: "Soupes" },
        { id: 6, nom: "Plateau de crudit√©s", rendement: 25, unite: "portions", coutMatiere: 1.20, tempsPrepMinutes: 30, allergenes: [], categorie: "Plateaux" },
        { id: 7, nom: "Quiche lorraine", rendement: 8, unite: "portions", coutMatiere: 2.75, tempsPrepMinutes: 90, allergenes: ["Gluten", "≈íufs", "Lait"], categorie: "Plats chauds" },
        { id: 8, nom: "Brochettes de poulet satay", rendement: 40, unite: "unit√©s", coutMatiere: 1.95, tempsPrepMinutes: 45, allergenes: ["Arachides", "Soja"], categorie: "Bouch√©es" }
      ],

      inventaire: [
        { id: 1, nom: "Farine tout usage", sku: "ING-001", stock: 40, unite: "kg", seuil: 20, lot: "LOT-2024-015", peremption: "2024-06-15", emplacement: "R√©serve s√®che A3" },
        { id: 2, nom: "Poulet frais", sku: "ING-002", stock: 25, unite: "kg", seuil: 10, lot: "LOT-2024-022", peremption: "2024-02-08", emplacement: "Frigo 1" },
        { id: 3, nom: "Tomates fra√Æches", sku: "ING-003", stock: 15, unite: "kg", seuil: 8, lot: "LOT-2024-018", peremption: "2024-02-10", emplacement: "Frigo 2" },
        { id: 4, nom: "Huile d'olive", sku: "ING-004", stock: 20, unite: "litres", seuil: 10, lot: "LOT-2023-145", peremption: "2025-01-15", emplacement: "R√©serve s√®che B2" },
        { id: 5, nom: "Fromage parmesan", sku: "ING-005", stock: 8, unite: "kg", seuil: 5, lot: "LOT-2024-009", peremption: "2024-03-20", emplacement: "Frigo 3" }
      ],

      evenements: [
        { id: 1, nom: "Cocktail d'entreprise ABC Inc.", date: "2024-02-10", heure: "17:00", convives: 150, lieu: "Centre-ville Montr√©al", statut: "Confirm√©", responsable: "Marie Lavoie" },
        { id: 2, nom: "Lunch corporatif Banque XYZ", date: "2024-02-08", heure: "12:00", convives: 50, lieu: "Tour de la Banque", statut: "En planification", responsable: "Jean Tremblay" },
        { id: 3, nom: "Mariage Tremblay-Gagnon", date: "2024-06-15", heure: "18:00", convives: 200, lieu: "Vignoble de l'Orpailleur", statut: "Soumission", responsable: "Sophie Bouchard" }
      ],

      demandes: [
        { id: 1, source: "Email", date: "2024-02-04 09:15", client: "Nouveau client", objet: "Demande de soumission - √âv√©nement corporatif", statut: "Nouvelle", priorite: "Normale" },
        { id: 2, source: "T√©l√©phone", date: "2024-02-04 10:30", client: "Jean Tremblay", objet: "Modification commande CMD-2024-001", statut: "En traitement", priorite: "Urgente" },
        { id: 3, source: "Web", date: "2024-02-03 14:45", client: "Sophie Bouchard", objet: "Question sur allerg√®nes", statut: "Ferm√©e", priorite: "Normale" }
      ],

      stats: {
        ventesJour: 4530,
        ventesHier: 3890,
        commandesJour: 12,
        nouveauxClients: 3,
        tauxConversion: 68
      }
    };

    // √âtat de navigation 5 NIVEAUX
    function App() {
      const [activeTab, setActiveTab] = React.useState('dashboard');
      const [view, setView] = React.useState({
        screen: 'list',
        entityType: null,
        entityId: null,
        subEntityType: null,
        subEntityId: null
      });

      const [showModal, setShowModal] = React.useState(false);
      const [isScrolled, setIsScrolled] = React.useState(false);

      React.useEffect(() => {
        const handleScroll = () => {
          setIsScrolled(window.scrollY > 10);
        };
        window.addEventListener('scroll', handleScroll);
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);
      const [modalType, setModalType] = React.useState('');
      const [searchTerm, setSearchTerm] = React.useState('');

      // Navigation 5 niveaux
      const goToList = (type) => setView({
        screen: 'list', entityType: type, entityId: null, subEntityType: null, subEntityId: null
      });

      const goToDetail = (type, id) => setView({
        screen: 'detail', entityType: type, entityId: id, subEntityType: null, subEntityId: null
      });

      const goToSubList = (parentType, parentId, subType) => setView({
        screen: 'sublist', entityType: parentType, entityId: parentId, subEntityType: subType, subEntityId: null
      });

      const goToEdit = (type, id) => setView({
        screen: 'edit', entityType: type, entityId: id, subEntityType: null, subEntityId: null
      });

      const goToSubDetail = (parentType, parentId, subType, subId) => setView({
        screen: 'subdetail', entityType: parentType, entityId: parentId, subEntityType: subType, subEntityId: subId
      });

      const goToSubEdit = (parentType, parentId, subType, subId) => setView({
        screen: 'subedit', entityType: parentType, entityId: parentId, subEntityType: subType, subEntityId: subId
      });

      // Composant BackButton
      const BackButton = ({ onClick, label = "Retour" }) => (
        <button
          onClick={onClick}
          className="flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-6 transition-colors"
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
          <span className="font-display">{label}</span>
        </button>
      );

      // Composant Card √©l√©gant avec profondeur am√©lior√©e - th√®me clair
      const Card = ({ children, className = "", hover = false, elevation = "normal" }) => {
        const elevationClasses = {
          low: 'shadow-sm',
          normal: 'shadow-md',
          high: 'shadow-lg',
          extra: 'shadow-xl'
        };

        const hoverClasses = hover ?
          'hover:border-gray-400 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300' :
          '';

        return (
          <div className={`bg-white rounded-xl border border-gray-300 ${elevationClasses[elevation]} ${hoverClasses} ${className}`}>
            {children}
          </div>
        );
      };

      // Composant Button raffin√© - th√®me avec contrastes am√©lior√©s
      const Button = ({ children, onClick, variant = "primary", size = "md", className = "" }) => {
        const variants = {
          primary: "bg-blue-600 text-white hover:bg-blue-700 border-2 border-blue-600 shadow-sm",
          secondary: "bg-white text-gray-800 hover:bg-gray-50 border-2 border-gray-400 shadow-sm",
          ghost: "text-gray-800 hover:text-gray-900 hover:bg-gray-100 border-2 border-transparent"
        };

        const sizes = {
          sm: "px-3 py-1.5 text-sm",
          md: "px-4 py-2",
          lg: "px-6 py-3 text-lg"
        };

        return (
          <button
            onClick={onClick}
            className={`font-display font-medium rounded-lg transition-all duration-200 ${variants[variant]} ${sizes[size]} ${className}`}
          >
            {children}
          </button>
        );
      };

      // Composant Gestion des Demandes avec IA
      const Demandes = () => {
        const [demandes, setDemandes] = React.useState(mockData.demandes);
        const [showClassificationIA, setShowClassificationIA] = React.useState(false);
        const [selectedDemande, setSelectedDemande] = React.useState(null);
        const [filterStatut, setFilterStatut] = React.useState('toutes');
        const [showDetailDemande, setShowDetailDemande] = React.useState(false);
        const [iaProcessing, setIaProcessing] = React.useState(false);

        // Statistiques des demandes
        const stats = {
          nouvelles: demandes.filter(d => d.statut === 'Nouvelle').length,
          enTraitement: demandes.filter(d => d.statut === 'En traitement').length,
          urgent: demandes.filter(d => d.priorite === 'Urgente').length,
          total: demandes.length
        };

        // Simuler le traitement IA d'un email
        const processEmailWithIA = (demande) => {
          setIaProcessing(true);
          setTimeout(() => {
            // R√©sultat simul√© de l'analyse IA
            const iaResult = {
              classification: 'Soumission',
              confiance: 92,
              extractedInfo: {
                dateEvenement: '2024-02-15',
                nbConvives: 50,
                typeService: 'Buffet',
                budget: '2500-3000$',
                allergenes: ['Sans gluten', 'V√©g√©tarien'],
                clientExistant: Math.random() > 0.5
              },
              suggestedActions: [
                'Cr√©er une soumission',
                'Envoyer accus√© de r√©ception',
                'Assigner √† l\'√©quipe commerciale'
              ]
            };
            setSelectedDemande({...demande, iaAnalysis: iaResult});
            setIaProcessing(false);
          }, 2000);
        };

        const filteredDemandes = filterStatut === 'toutes'
          ? demandes
          : demandes.filter(d => d.statut === filterStatut);

        return (
          <div className="space-y-6">
            {/* En-t√™te avec statistiques */}
            <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
              <h1 className="text-2xl font-display font-bold text-gray-900">
                Gestion des Demandes & IA
              </h1>
              <Button
                onClick={() => setShowClassificationIA(true)}
                className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg"
              >
                <span className="mr-2">ü§ñ</span>
                Configuration IA
              </Button>
            </div>

            {/* Cartes de statistiques avec meilleur contraste */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
              <Card className="p-4 bg-white border-gray-300">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-gray-700">Nouvelles</p>
                    <p className="text-2xl font-bold text-gray-900">{stats.nouvelles}</p>
                  </div>
                  <div className="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                    <span className="text-blue-700 text-xl">üìß</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4 bg-white border-gray-300">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-gray-700">En traitement</p>
                    <p className="text-2xl font-bold text-gray-900">{stats.enTraitement}</p>
                  </div>
                  <div className="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                    <span className="text-yellow-700 text-xl">‚è≥</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4 bg-white border-gray-300">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-gray-700">Urgent</p>
                    <p className="text-2xl font-bold text-gray-900">{stats.urgent}</p>
                  </div>
                  <div className="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                    <span className="text-red-700 text-xl">üî•</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4 bg-white border-gray-300">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-gray-700">Total</p>
                    <p className="text-2xl font-bold text-gray-900">{stats.total}</p>
                  </div>
                  <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                    <span className="text-gray-700 text-xl">üìä</span>
                  </div>
                </div>
              </Card>
            </div>

            {/* Filtres avec meilleur contraste */}
            <Card className="p-4 bg-white border-gray-300">
              <div className="flex flex-wrap items-center gap-3">
                <span className="text-sm font-medium text-gray-700">Filtrer par statut:</span>
                {['toutes', 'Nouvelle', 'En traitement', 'En attente client', 'Ferm√©e'].map(statut => (
                  <button
                    key={statut}
                    onClick={() => setFilterStatut(statut)}
                    className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                      filterStatut === statut
                        ? 'bg-gray-900 text-white shadow-sm'
                        : 'bg-white text-gray-800 hover:bg-gray-50 border border-gray-300'
                    }`}
                  >
                    {statut.charAt(0).toUpperCase() + statut.slice(1)}
                  </button>
                ))}
              </div>
            </Card>

            {/* Liste des demandes */}
            <Card className="overflow-hidden bg-white border-gray-300">
              <div className="p-4 bg-gray-50 border-b border-gray-300">
                <h2 className="font-display font-semibold text-gray-900">
                  Liste des demandes ({filteredDemandes.length})
                </h2>
              </div>
              <div className="divide-y divide-gray-200">
                {filteredDemandes.map(demande => (
                  <div
                    key={demande.id}
                    className="p-4 hover:bg-gray-50 transition-colors cursor-pointer"
                    onClick={() => {
                      setSelectedDemande(demande);
                      setShowDetailDemande(true);
                    }}
                  >
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <div className="flex items-center gap-3 mb-1">
                          <span className={`px-2 py-1 text-xs font-medium rounded ${
                            demande.source === 'Email' ? 'bg-blue-600 text-white' :
                            demande.source === 'T√©l√©phone' ? 'bg-green-600 text-white' :
                            'bg-purple-600 text-white'
                          }`}>
                            {demande.source}
                          </span>
                          <span className={`px-2 py-1 text-xs font-medium rounded ${
                            demande.priorite === 'Urgente' ? 'bg-red-600 text-white' :
                            'bg-gray-600 text-white'
                          }`}>
                            {demande.priorite}
                          </span>
                          <span className="text-xs text-gray-600">{demande.date}</span>
                        </div>
                        <p className="font-medium text-gray-900">{demande.objet}</p>
                        <p className="text-sm text-gray-700 mt-1">Client: {demande.client}</p>
                      </div>
                      <div className="flex items-center gap-2 ml-4">
                        <span className={`px-3 py-1 text-xs font-medium rounded-full ${
                          demande.statut === 'Nouvelle' ? 'bg-blue-600 text-white' :
                          demande.statut === 'En traitement' ? 'bg-yellow-600 text-white' :
                          demande.statut === 'En attente client' ? 'bg-orange-600 text-white' :
                          'bg-green-600 text-white'
                        }`}>
                          {demande.statut}
                        </span>
                        <Button
                          size="sm"
                          onClick={(e) => {
                            e.stopPropagation();
                            processEmailWithIA(demande);
                          }}
                          className="bg-purple-600 hover:bg-purple-700 text-white"
                        >
                          <span className="text-xs">ü§ñ Analyser</span>
                        </Button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </Card>

            {/* Modal Classification IA */}
            {showClassificationIA && (
              <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                <Card className="w-full max-w-3xl max-h-[90vh] overflow-y-auto bg-white">
                  <div className="p-6">
                    <h2 className="text-xl font-display font-bold text-gray-900 mb-4">
                      Configuration de l'Assistant IA
                    </h2>

                    <div className="space-y-6">
                      {/* Configuration de classification */}
                      <div>
                        <h3 className="font-medium text-gray-900 mb-3">Classification automatique</h3>
                        <div className="space-y-3">
                          {['Soumission', 'Commande', 'Facture', 'Support', 'Spam/Promo'].map(type => (
                            <label key={type} className="flex items-center gap-3 p-3 rounded-lg bg-gray-50 hover:bg-gray-100 cursor-pointer">
                              <input
                                type="checkbox"
                                defaultChecked={type !== 'Spam/Promo'}
                                className="w-4 h-4 text-blue-700 bg-white border-gray-400 rounded focus:ring-blue-600"
                              />
                              <span className="text-gray-900">{type}</span>
                              <span className="ml-auto text-sm text-gray-600">
                                {type === 'Soumission' ? 'Demandes de prix' :
                                 type === 'Commande' ? 'Confirmations' :
                                 type === 'Facture' ? 'Questions comptables' :
                                 type === 'Support' ? 'Assistance client' :
                                 'Courriels non sollicit√©s'}
                              </span>
                            </label>
                          ))}
                        </div>
                      </div>

                      {/* Seuil de confiance */}
                      <div>
                        <h3 className="font-medium text-gray-900 mb-3">Seuil de confiance IA</h3>
                        <div className="flex items-center gap-4">
                          <input
                            type="range"
                            min="70"
                            max="95"
                            defaultValue="85"
                            className="flex-1"
                          />
                          <span className="text-gray-900 font-medium">85%</span>
                        </div>
                        <p className="text-sm text-gray-600 mt-2">
                          Les actions automatiques ne seront ex√©cut√©es que si la confiance d√©passe ce seuil
                        </p>
                      </div>

                      {/* Actions automatiques */}
                      <div>
                        <h3 className="font-medium text-gray-900 mb-3">Actions automatiques</h3>
                        <div className="space-y-2">
                          <label className="flex items-center gap-3">
                            <input type="checkbox" defaultChecked className="w-4 h-4 text-blue-600" />
                            <span className="text-gray-900">Envoyer accus√© de r√©ception automatique</span>
                          </label>
                          <label className="flex items-center gap-3">
                            <input type="checkbox" defaultChecked className="w-4 h-4 text-blue-600" />
                            <span className="text-gray-900">Cr√©er t√¢ches selon le type de demande</span>
                          </label>
                          <label className="flex items-center gap-3">
                            <input type="checkbox" defaultChecked className="w-4 h-4 text-blue-600" />
                            <span className="text-gray-900">Associer au client existant si trouv√©</span>
                          </label>
                          <label className="flex items-center gap-3">
                            <input type="checkbox" className="w-4 h-4 text-blue-600" />
                            <span className="text-gray-900">Alerter pour clients VIP</span>
                          </label>
                        </div>
                      </div>
                    </div>

                    <div className="flex gap-3 mt-6">
                      <Button type="submit" className="bg-gray-900 hover:bg-black text-white shadow-md">
                        Enregistrer la configuration
                      </Button>
                      <Button
                        variant="secondary"
                        onClick={() => setShowClassificationIA(false)}
                        className="bg-white hover:bg-gray-50 text-gray-900 border-2 border-gray-400"
                      >
                        Annuler
                      </Button>
                    </div>
                  </div>
                </Card>
              </div>
            )}

            {/* Modal D√©tail Demande avec Analyse IA */}
            {showDetailDemande && selectedDemande && (
              <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                <Card className="w-full max-w-4xl max-h-[90vh] overflow-y-auto bg-white">
                  <div className="p-6">
                    <div className="flex items-start justify-between mb-6">
                      <div>
                        <h2 className="text-xl font-display font-bold text-gray-900">
                          D√©tail de la demande #{selectedDemande.id}
                        </h2>
                        <p className="text-sm text-gray-600 mt-1">{selectedDemande.date}</p>
                      </div>
                      <button
                        onClick={() => {
                          setShowDetailDemande(false);
                          setSelectedDemande(null);
                        }}
                        className="p-2 hover:bg-gray-100 rounded-lg"
                      >
                        <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                        </svg>
                      </button>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                      {/* Informations de la demande */}
                      <div>
                        <h3 className="font-medium text-gray-900 mb-3">Informations</h3>
                        <div className="space-y-3 bg-gray-50 p-4 rounded-lg">
                          <div>
                            <span className="text-sm text-gray-600">Source:</span>
                            <span className="ml-2 font-medium text-gray-900">{selectedDemande.source}</span>
                          </div>
                          <div>
                            <span className="text-sm text-gray-600">Client:</span>
                            <span className="ml-2 font-medium text-gray-900">{selectedDemande.client}</span>
                          </div>
                          <div>
                            <span className="text-sm text-gray-600">Objet:</span>
                            <p className="font-medium text-gray-900 mt-1">{selectedDemande.objet}</p>
                          </div>
                          <div>
                            <span className="text-sm text-gray-600">Statut:</span>
                            <span className={`ml-2 px-3 py-1 text-xs font-medium rounded-full ${
                              selectedDemande.statut === 'Nouvelle' ? 'bg-blue-100 text-blue-800' :
                              selectedDemande.statut === 'En traitement' ? 'bg-yellow-100 text-yellow-800' :
                              'bg-green-100 text-green-800'
                            }`}>
                              {selectedDemande.statut}
                            </span>
                          </div>
                          <div>
                            <span className="text-sm text-gray-600">Priorit√©:</span>
                            <span className={`ml-2 px-3 py-1 text-xs font-medium rounded-full ${
                              selectedDemande.priorite === 'Urgente' ? 'bg-red-100 text-red-800' :
                              'bg-gray-100 text-gray-800'
                            }`}>
                              {selectedDemande.priorite}
                            </span>
                          </div>
                        </div>
                      </div>

                      {/* Analyse IA */}
                      <div>
                        <h3 className="font-medium text-gray-900 mb-3">Analyse IA</h3>
                        {iaProcessing ? (
                          <div className="bg-purple-50 p-8 rounded-lg text-center">
                            <div className="animate-spin rounded-full h-12 w-12 border-4 border-purple-600 border-t-transparent mx-auto mb-4"></div>
                            <p className="text-purple-900 font-medium">Analyse en cours...</p>
                          </div>
                        ) : selectedDemande.iaAnalysis ? (
                          <div className="space-y-4">
                            <div className="bg-purple-50 p-4 rounded-lg">
                              <div className="flex items-center justify-between mb-3">
                                <span className="text-sm font-medium text-purple-900">Classification IA</span>
                                <span className="text-sm text-purple-700">Confiance: {selectedDemande.iaAnalysis.confiance}%</span>
                              </div>
                              <p className="text-lg font-semibold text-purple-900">
                                {selectedDemande.iaAnalysis.classification}
                              </p>
                            </div>

                            <div className="bg-gray-50 p-4 rounded-lg">
                              <h4 className="text-sm font-medium text-gray-900 mb-3">Informations extraites</h4>
                              <div className="space-y-2 text-sm">
                                <div>üìÖ Date √©v√©nement: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.dateEvenement}</span></div>
                                <div>üë• Nombre de convives: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.nbConvives}</span></div>
                                <div>üçΩÔ∏è Type de service: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.typeService}</span></div>
                                <div>üí∞ Budget: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.budget}</span></div>
                                <div>‚ö†Ô∏è Restrictions: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.allergenes.join(', ')}</span></div>
                                <div>üë§ Client existant: <span className="font-medium">{selectedDemande.iaAnalysis.extractedInfo.clientExistant ? 'Oui' : 'Non'}</span></div>
                              </div>
                            </div>

                            <div className="bg-blue-50 p-4 rounded-lg">
                              <h4 className="text-sm font-medium text-blue-900 mb-3">Actions sugg√©r√©es</h4>
                              <div className="space-y-2">
                                {selectedDemande.iaAnalysis.suggestedActions.map((action, idx) => (
                                  <label key={idx} className="flex items-center gap-3">
                                    <input type="checkbox" className="w-4 h-4 text-blue-600" />
                                    <span className="text-sm text-blue-900">{action}</span>
                                  </label>
                                ))}
                              </div>
                            </div>
                          </div>
                        ) : (
                          <div className="bg-gray-50 p-8 rounded-lg text-center">
                            <p className="text-gray-600 mb-4">Aucune analyse IA disponible</p>
                            <Button
                              size="sm"
                              onClick={() => processEmailWithIA(selectedDemande)}
                              className="bg-purple-600 hover:bg-purple-700 text-white"
                            >
                              ü§ñ Lancer l'analyse
                            </Button>
                          </div>
                        )}
                      </div>
                    </div>

                    {/* Actions */}
                    <div className="flex gap-3 mt-6">
                      <Button className="bg-gray-900 hover:bg-gray-800 text-white">
                        Cr√©er une soumission
                      </Button>
                      <Button className="bg-blue-700 hover:bg-blue-800 text-white">
                        Assigner √†
                      </Button>
                      <Button variant="secondary" className="bg-gray-200 hover:bg-gray-300 text-gray-900">
                        Changer le statut
                      </Button>
                      <Button
                        variant="secondary"
                        onClick={() => {
                          setShowDetailDemande(false);
                          setSelectedDemande(null);
                        }}
                        className="ml-auto bg-gray-200 hover:bg-gray-300 text-gray-900"
                      >
                        Fermer
                      </Button>
                    </div>
                  </div>
                </Card>
              </div>
            )}
          </div>
        );
      };

      // Composant Dashboard
      const Dashboard = () => {
        const statsCards = [
          { label: "Ventes aujourd'hui", value: `${mockData.stats.ventesJour.toLocaleString()} $`, change: "+16%", icon: "üí∞" },
          { label: "Commandes", value: mockData.stats.commandesJour, change: "+3", icon: "üì¶" },
          { label: "Nouveaux clients", value: mockData.stats.nouveauxClients, change: "", icon: "üë•" },
          { label: "Taux conversion", value: `${mockData.stats.tauxConversion}%`, change: "+5%", icon: "üìà" }
        ];

        // Donn√©es pour le graphique
        const revenueData = [
          { jour: 'Lun', montant: 3200 },
          { jour: 'Mar', montant: 4100 },
          { jour: 'Mer', montant: 3800 },
          { jour: 'Jeu', montant: 3890 },
          { jour: 'Ven', montant: 4530 },
          { jour: 'Sam', montant: 5200 },
          { jour: 'Dim', montant: 2100 }
        ];

        return (
          <div className="space-y-8">
            <div className="flex items-center justify-between">
              <h1 className="text-3xl font-display font-bold text-gray-800">Tableau de bord</h1>
              <div className="text-sm text-gray-600">{new Date().toLocaleDateString('fr-CA')}</div>
            </div>

            {/* KPIs */}
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
              {statsCards.map((stat, i) => (
                <Card key={i} className="p-6 animate-fade-in-up" style={{ animationDelay: `${i * 100}ms` }}>
                  <div className="flex items-start justify-between">
                    <div className="space-y-2">
                      <p className="text-sm text-gray-600 font-body">{stat.label}</p>
                      <p className="text-2xl font-display font-bold text-gray-800">{stat.value}</p>
                      {stat.change && (
                        <p className={`text-sm ${stat.change.includes('+') ? 'text-green-400' : 'text-gray-600'}`}>
                          {stat.change}
                        </p>
                      )}
                    </div>
                    <div className="text-3xl opacity-20">{stat.icon}</div>
                  </div>
                </Card>
              ))}
            </div>

            {/* Graphique des revenus */}
            <Card className="p-6">
              <h2 className="text-xl font-display font-semibold text-gray-800 mb-6">Revenus de la semaine</h2>
              <ResponsiveContainer width="100%" height={300}>
                <AreaChart data={revenueData}>
                  <defs>
                    <linearGradient id="colorRevenue" x1="0" y1="0" x2="0" y2="1">
                      <stop offset="5%" stopColor="#000000" stopOpacity={0.3}/>
                      <stop offset="95%" stopColor="#000000" stopOpacity={0}/>
                    </linearGradient>
                  </defs>
                  <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
                  <XAxis dataKey="jour" stroke="#9CA3AF" />
                  <YAxis stroke="#9CA3AF" />
                  <Tooltip
                    contentStyle={{ backgroundColor: '#1F2937', border: '1px solid #374151', borderRadius: '8px' }}
                    labelStyle={{ color: '#E5E7EB' }}
                  />
                  <Area type="monotone" dataKey="montant" stroke="#000000" fillOpacity={1} fill="url(#colorRevenue)" strokeWidth={2} />
                </AreaChart>
              </ResponsiveContainer>
            </Card>

            {/* Actions rapides */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              <Card hover className="p-6 cursor-pointer" onClick={() => { setActiveTab('demandes'); }}>
                <div className="flex items-center justify-between">
                  <div>
                    <h3 className="font-display font-semibold text-gray-800">Nouvelles demandes</h3>
                    <p className="text-2xl font-bold text-gray-800 mt-2">3</p>
                    <p className="text-sm text-gray-600">√† traiter</p>
                  </div>
                  <svg className="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                  </svg>
                </div>
              </Card>

              <Card hover className="p-6 cursor-pointer" onClick={() => { setActiveTab('production'); }}>
                <div className="flex items-center justify-between">
                  <div>
                    <h3 className="font-display font-semibold text-gray-800">Commandes du jour</h3>
                    <p className="text-2xl font-bold text-gray-800 mt-2">12</p>
                    <p className="text-sm text-gray-600">en production</p>
                  </div>
                  <svg className="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                  </svg>
                </div>
              </Card>

              <Card hover className="p-6 cursor-pointer" onClick={() => { setActiveTab('inventaire'); }}>
                <div className="flex items-center justify-between">
                  <div>
                    <h3 className="font-display font-semibold text-gray-800">Alertes inventaire</h3>
                    <p className="text-2xl font-bold text-red-400 mt-2">2</p>
                    <p className="text-sm text-gray-600">stocks critiques</p>
                  </div>
                  <svg className="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                  </svg>
                </div>
              </Card>
            </div>
          </div>
        );
      };

      // Composant Liste des Clients
      const ClientList = ({ onSelect }) => {
        const filteredClients = mockData.clients.filter(client =>
          client.nom.toLowerCase().includes(searchTerm.toLowerCase()) ||
          client.entreprise.toLowerCase().includes(searchTerm.toLowerCase())
        );

        return (
          <div className="space-y-6">
            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
              <h1 className="text-2xl font-display font-bold text-gray-800">Clients</h1>
              <div className="flex gap-3">
                <input
                  type="text"
                  placeholder="Rechercher..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-black/50 focus:border-transparent"
                />
                <Button onClick={() => { setModalType('client'); setShowModal(true); }}>
                  Nouveau client
                </Button>
              </div>
            </div>

            <Card className="overflow-hidden">
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-300 border-b border-gray-400">
                    <tr>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Nom</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Entreprise</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Contact</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Balance</th>
                      <th className="px-6 py-4 text-right text-sm font-display font-medium text-gray-600">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {filteredClients.map((client, i) => (
                      <tr
                        key={client.id}
                        onClick={() => onSelect(client.id)}
                        className="hover:bg-gray-100 cursor-pointer transition-colors animate-fade-in-up"
                        style={{ animationDelay: `${i * 50}ms` }}
                      >
                        <td className="px-6 py-4 text-gray-800 font-body">{client.nom}</td>
                        <td className="px-6 py-4 text-gray-800">{client.entreprise}</td>
                        <td className="px-6 py-4">
                          <div className="text-sm">
                            <div className="text-gray-800">{client.email}</div>
                            <div className="text-gray-600">{client.telephone}</div>
                          </div>
                        </td>
                        <td className="px-6 py-4">
                          <span className={`font-semibold ${client.balance > 0 ? 'text-orange-400' : 'text-green-400'}`}>
                            {client.balance.toLocaleString()} $
                          </span>
                        </td>
                        <td className="px-6 py-4 text-right">
                          <button
                            onClick={(e) => { e.stopPropagation(); goToEdit('client', client.id); }}
                            className="text-gray-600 hover:text-gray-800 transition-colors"
                          >
                            Modifier
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </Card>
          </div>
        );
      };

      // Composant D√©tail Client
      const ClientDetail = ({ clientId, onBack }) => {
        const client = mockData.clients.find(c => c.id === clientId);
        if (!client) return <div>Client non trouv√©</div>;

        const clientCommandes = mockData.commandes.filter(c => c.clientId === clientId);

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour aux clients" />

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-3xl font-display font-bold text-gray-800">{client.nom}</h1>
                <p className="text-lg text-gray-600">{client.entreprise}</p>
              </div>
              <div className="flex gap-3">
                <Button variant="secondary" onClick={() => goToEdit('client', clientId)}>Modifier</Button>
                <Button variant="ghost">Supprimer</Button>
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">Informations de contact</h3>
                <dl className="space-y-3">
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Email</dt>
                    <dd className="text-gray-800">{client.email}</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">T√©l√©phone</dt>
                    <dd className="text-gray-800">{client.telephone}</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Type</dt>
                    <dd className="text-gray-800">{client.type}</dd>
                  </div>
                </dl>
              </Card>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">Informations financi√®res</h3>
                <dl className="space-y-3">
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Limite de cr√©dit</dt>
                    <dd className="text-gray-800">{client.credit.toLocaleString()} $</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Balance actuelle</dt>
                    <dd className={`font-semibold ${client.balance > 0 ? 'text-orange-400' : 'text-green-400'}`}>
                      {client.balance.toLocaleString()} $
                    </dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Derni√®re commande</dt>
                    <dd className="text-gray-800">{client.dernierCommande}</dd>
                  </div>
                </dl>
              </Card>
            </div>

            {/* Section des commandes r√©centes */}
            <Card className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h3 className="font-display font-semibold text-gray-800">Commandes r√©centes</h3>
                <button
                  onClick={() => goToSubList('client', clientId, 'commande')}
                  className="text-sm text-gray-600 hover:text-gray-800 transition-colors flex items-center gap-1"
                >
                  Voir toutes les commandes
                  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                  </svg>
                </button>
              </div>

              <div className="space-y-3">
                {clientCommandes.slice(0, 3).map(cmd => (
                  <div
                    key={cmd.id}
                    onClick={() => goToSubDetail('client', clientId, 'commande', cmd.id)}
                    className="p-4 bg-gray-200 rounded-lg hover:bg-gray-300 cursor-pointer transition-colors"
                  >
                    <div className="flex items-center justify-between">
                      <div>
                        <p className="font-medium text-gray-800">{cmd.numero}</p>
                        <p className="text-sm text-gray-600">{cmd.date} ‚Ä¢ {cmd.items} items</p>
                      </div>
                      <div className="text-right">
                        <p className="font-semibold text-gray-800">{cmd.montant.toLocaleString()} $</p>
                        <p className="text-sm text-gray-600">{cmd.statut}</p>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </Card>
          </div>
        );
      };

      // Composant √âdition Client
      const ClientEdit = ({ clientId, onBack }) => {
        const client = mockData.clients.find(c => c.id === clientId);
        const [formData, setFormData] = React.useState({
          nom: client?.nom || '',
          entreprise: client?.entreprise || '',
          email: client?.email || '',
          telephone: client?.telephone || '',
          type: client?.type || 'B2B',
          credit: client?.credit || '',
          balance: client?.balance || 0
        });

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour au client" />

            <h1 className="text-2xl font-display font-bold text-gray-800">
              {clientId ? `Modifier ${client?.nom}` : 'Nouveau client'}
            </h1>

            <Card className="p-6">
              <form className="space-y-6" onSubmit={(e) => {
                e.preventDefault();
                // Simuler la sauvegarde
                alert('Client modifi√© avec succ√®s!');
                onBack();
              }}>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Nom complet
                    </label>
                    <input
                      type="text"
                      value={formData.nom}
                      onChange={(e) => setFormData({...formData, nom: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: Jean Tremblay"
                      required
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Entreprise
                    </label>
                    <input
                      type="text"
                      value={formData.entreprise}
                      onChange={(e) => setFormData({...formData, entreprise: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: Restaurant Chez Marcel"
                      required
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Email
                    </label>
                    <input
                      type="email"
                      value={formData.email}
                      onChange={(e) => setFormData({...formData, email: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: jean@chezmarcel.ca"
                      required
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      T√©l√©phone
                    </label>
                    <input
                      type="tel"
                      value={formData.telephone}
                      onChange={(e) => setFormData({...formData, telephone: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: (514) 555-1234"
                      required
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Type de client
                    </label>
                    <select
                      value={formData.type}
                      onChange={(e) => setFormData({...formData, type: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                    >
                      <option value="B2B">B2B</option>
                      <option value="B2C">B2C</option>
                      <option value="VIP">VIP</option>
                    </select>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Limite de cr√©dit
                    </label>
                    <input
                      type="number"
                      value={formData.credit}
                      onChange={(e) => setFormData({...formData, credit: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: 10000"
                      min="0"
                      step="100"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Balance actuelle
                    </label>
                    <input
                      type="number"
                      value={formData.balance}
                      onChange={(e) => setFormData({...formData, balance: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="0"
                      min="0"
                      step="0.01"
                      disabled
                    />
                    <p className="text-sm text-gray-500 mt-1">La balance est calcul√©e automatiquement</p>
                  </div>
                </div>

                <div className="flex justify-end gap-3 pt-6 border-t border-gray-400">
                  <Button type="button" variant="ghost" onClick={onBack}>
                    Annuler
                  </Button>
                  <Button type="submit">
                    Enregistrer les modifications
                  </Button>
                </div>
              </form>
            </Card>
          </div>
        );
      };

      // Composant Liste des Commandes d'un client (Niveau 3)
      const CommandesList = ({ clientId, onBack, onSelect }) => {
        const client = mockData.clients.find(c => c.id === clientId);
        const clientCommandes = mockData.commandes.filter(c => c.clientId === clientId);

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label={`Retour √† ${client.nom}`} />

            <div>
              <h1 className="text-2xl font-display font-bold text-gray-800">Commandes de {client.nom}</h1>
              <p className="text-gray-600">{client.entreprise}</p>
            </div>

            <Card className="overflow-hidden">
              <table className="w-full">
                <thead className="bg-gray-300 border-b border-gray-400">
                  <tr>
                    <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Num√©ro</th>
                    <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Date</th>
                    <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Statut</th>
                    <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Livraison</th>
                    <th className="px-6 py-4 text-right text-sm font-display font-medium text-gray-600">Montant</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-700">
                  {clientCommandes.map(cmd => (
                    <tr
                      key={cmd.id}
                      onClick={() => onSelect(cmd.id)}
                      className="hover:bg-gray-200 cursor-pointer transition-colors"
                    >
                      <td className="px-6 py-4 font-medium text-gray-800">{cmd.numero}</td>
                      <td className="px-6 py-4 text-gray-800">{cmd.date}</td>
                      <td className="px-6 py-4">
                        <span className={`px-2 py-1 text-xs rounded-full ${
                          cmd.statut === 'Livr√©e' ? 'bg-green-300 text-green-950 border border-green-400' :
                          cmd.statut === 'En pr√©paration' ? 'bg-blue-300 text-blue-950 border border-blue-400' :
                          cmd.statut === 'Confirm√©e' ? 'bg-gray-300 text-gray-950 border border-gray-400' :
                          'bg-yellow-300 text-yellow-950 border border-yellow-400'
                        }`}>
                          {cmd.statut}
                        </span>
                      </td>
                      <td className="px-6 py-4 text-gray-800">{cmd.livraison}</td>
                      <td className="px-6 py-4 text-right font-semibold text-gray-800">
                        {cmd.montant.toLocaleString()} $
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </Card>
          </div>
        );
      };

      // Composant D√©tail Commande (Niveau 4)
      const CommandeDetail = ({ commandeId, onBack, onEdit }) => {
        const commande = mockData.commandes.find(c => c.id === commandeId);
        const client = mockData.clients.find(c => c.id === commande?.clientId);

        if (!commande) return <div>Commande non trouv√©e</div>;

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour aux commandes" />

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-2xl font-display font-bold text-gray-800">Commande {commande.numero}</h1>
                <p className="text-gray-600">{client.nom} - {client.entreprise}</p>
              </div>
              <Button onClick={() => onEdit()}>Modifier</Button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-3">Informations</h3>
                <dl className="space-y-2">
                  <div>
                    <dt className="text-sm text-gray-600">Date commande</dt>
                    <dd className="text-gray-800">{commande.date}</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600">Livraison pr√©vue</dt>
                    <dd className="text-gray-800">{commande.livraison}</dd>
                  </div>
                </dl>
              </Card>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-3">Statut</h3>
                <span className={`inline-block px-3 py-1.5 text-sm rounded-full ${
                  commande.statut === 'Livr√©e' ? 'bg-green-300 text-green-950 border border-green-400' :
                  commande.statut === 'En pr√©paration' ? 'bg-blue-300 text-blue-950 border border-blue-400' :
                  'bg-yellow-300 text-yellow-950 border border-yellow-400'
                }`}>
                  {commande.statut}
                </span>
              </Card>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-3">Total</h3>
                <p className="text-2xl font-bold text-gray-800">{commande.montant.toLocaleString()} $</p>
                <p className="text-sm text-gray-600">{commande.items} articles</p>
              </Card>
            </div>

            <Card className="p-6">
              <h3 className="font-display font-semibold text-gray-800 mb-4">Articles command√©s</h3>
              <div className="space-y-3">
                <div className="p-4 bg-gray-200 rounded-lg">
                  <div className="flex items-center justify-between">
                    <div>
                      <p className="font-medium text-gray-800">Plateau de sandwichs vari√©s</p>
                      <p className="text-sm text-gray-600">3 unit√©s √ó 65 $</p>
                    </div>
                    <p className="font-semibold text-gray-800">195 $</p>
                  </div>
                </div>
                <div className="p-4 bg-gray-200 rounded-lg">
                  <div className="flex items-center justify-between">
                    <div>
                      <p className="font-medium text-gray-800">Box √† lunch compl√®te</p>
                      <p className="text-sm text-gray-600">50 unit√©s √ó 18.50 $</p>
                    </div>
                    <p className="font-semibold text-gray-800">925 $</p>
                  </div>
                </div>
              </div>
            </Card>
          </div>
        );
      };

      // Composant √âdition Commande (Niveau 5)
      const CommandeEdit = ({ commandeId, onBack }) => {
        const commande = mockData.commandes.find(c => c.id === commandeId);
        const [formData, setFormData] = React.useState({
          statut: commande?.statut || '',
          livraison: commande?.livraison || ''
        });

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour au d√©tail" />

            <h1 className="text-2xl font-display font-bold text-gray-800">
              Modifier commande {commande?.numero}
            </h1>

            <Card className="p-6">
              <form className="space-y-4" onSubmit={(e) => {
                e.preventDefault();
                // Sauvegarder et retourner
                onBack();
              }}>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Statut
                  </label>
                  <select
                    value={formData.statut}
                    onChange={(e) => setFormData({...formData, statut: e.target.value})}
                    className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                  >
                    <option value="Confirm√©e">Confirm√©e</option>
                    <option value="En pr√©paration">En pr√©paration</option>
                    <option value="En production">En production</option>
                    <option value="Livr√©e">Livr√©e</option>
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Date et heure de livraison
                  </label>
                  <input
                    type="text"
                    value={formData.livraison}
                    onChange={(e) => setFormData({...formData, livraison: e.target.value})}
                    className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                  />
                </div>

                <div className="flex gap-3 pt-4">
                  <Button type="submit">Enregistrer</Button>
                  <Button type="button" variant="secondary" onClick={onBack}>Annuler</Button>
                </div>
              </form>
            </Card>
          </div>
        );
      };

      // Composant Production
      const Production = () => {
        const [showPrepList, setShowPrepList] = React.useState(false);
        const commandesJour = mockData.commandes.filter(c =>
          c.livraison.includes('2024-02-04') || c.livraison.includes('2024-02-05')
        );

        // G√©n√©rer la prep list en agr√©geant les ingr√©dients n√©cessaires
        const generatePrepList = () => {
          // Simuler une prep list bas√©e sur les commandes du jour
          const prepItems = [
            { ingredient: "Poulet grill√©", quantite: 8, unite: "kg", commandes: 3 },
            { ingredient: "Pain", quantite: 80, unite: "tranches", commandes: 3 },
            { ingredient: "Laitue", quantite: 4, unite: "kg", commandes: 3 },
            { ingredient: "Tomates", quantite: 2, unite: "kg", commandes: 3 },
            { ingredient: "Mayonnaise", quantite: 1, unite: "litre", commandes: 3 },
            { ingredient: "Wrap tortilla", quantite: 60, unite: "unit√©s", commandes: 2 },
            { ingredient: "Fromage", quantite: 3, unite: "kg", commandes: 2 },
            { ingredient: "Fruits frais vari√©s", quantite: 10, unite: "kg", commandes: 1 }
          ];
          return prepItems;
        };

        const prepList = generatePrepList();

        return (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h1 className="text-2xl font-display font-bold text-gray-800">Production du jour</h1>
              <Button onClick={() => setShowPrepList(!showPrepList)}>
                {showPrepList ? 'Masquer prep list' : 'G√©n√©rer prep list'}
              </Button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">√Ä pr√©parer</p>
                    <p className="text-2xl font-bold text-gray-800">5</p>
                  </div>
                  <div className="w-12 h-12 bg-yellow-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-yellow-400">‚è≥</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">En production</p>
                    <p className="text-2xl font-bold text-gray-800">3</p>
                  </div>
                  <div className="w-12 h-12 bg-blue-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-blue-400">üî•</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Termin√©es</p>
                    <p className="text-2xl font-bold text-gray-800">8</p>
                  </div>
                  <div className="w-12 h-12 bg-green-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-green-400">‚úì</span>
                  </div>
                </div>
              </Card>
            </div>

            {/* Affichage de la prep list */}
            {showPrepList && (
              <Card className="overflow-hidden animate-fade-in">
                <div className="p-4 border-b border-gray-400 bg-gray-300">
                  <div className="flex items-center justify-between">
                    <h2 className="font-display font-semibold text-gray-800">Liste de pr√©paration</h2>
                    <div className="flex gap-2">
                      <Button size="sm" variant="secondary">Imprimer</Button>
                      <Button size="sm" variant="secondary">Exporter PDF</Button>
                    </div>
                  </div>
                </div>
                <div className="p-6">
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="border-b border-gray-400">
                        <tr>
                          <th className="pb-3 text-left text-sm font-medium text-gray-600">Ingr√©dient</th>
                          <th className="pb-3 text-left text-sm font-medium text-gray-600">Quantit√© totale</th>
                          <th className="pb-3 text-left text-sm font-medium text-gray-600">Nombre de commandes</th>
                          <th className="pb-3 text-left text-sm font-medium text-gray-600">Statut</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-700">
                        {prepList.map((item, idx) => (
                          <tr key={idx} className="hover:bg-gray-100 transition-colors">
                            <td className="py-3 text-gray-800 font-medium">{item.ingredient}</td>
                            <td className="py-3 text-gray-800">
                              <span className="font-semibold">{item.quantite}</span> {item.unite}
                            </td>
                            <td className="py-3 text-gray-800">{item.commandes} commandes</td>
                            <td className="py-3">
                              <input
                                type="checkbox"
                                className="w-4 h-4 rounded border-gray-600 bg-gray-200 text-black focus:ring-black focus:ring-offset-0"
                              />
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>

                  <div className="mt-6 p-4 bg-gray-100 rounded-lg">
                    <h3 className="font-medium text-gray-800 mb-2">Notes de production:</h3>
                    <ul className="space-y-1 text-sm text-gray-600">
                      <li>‚Ä¢ Pr√©parer le poulet grill√© en premier (temps de cuisson: 20 min)</li>
                      <li>‚Ä¢ Laver et pr√©parer tous les l√©gumes frais</li>
                      <li>‚Ä¢ Assembler les plateaux de fruits en dernier pour la fra√Æcheur</li>
                      <li>‚Ä¢ V√©rifier les allerg√®nes pour chaque commande</li>
                    </ul>
                  </div>
                </div>
              </Card>
            )}

            <Card className="overflow-hidden">
              <div className="p-4 border-b border-gray-400">
                <h2 className="font-display font-semibold text-gray-800">Commandes √† produire</h2>
              </div>
              <div className="divide-y divide-gray-700">
                {commandesJour.map(cmd => {
                  const client = mockData.clients.find(c => c.id === cmd.clientId);
                  return (
                    <div key={cmd.id} className="p-4 hover:bg-gray-100 transition-colors">
                      <div className="flex items-center justify-between">
                        <div>
                          <p className="font-medium text-gray-800">{cmd.numero}</p>
                          <p className="text-sm text-gray-600">{client?.nom} ‚Ä¢ {cmd.items} items</p>
                          <p className="text-sm text-gray-700">Livraison: {cmd.livraison}</p>
                        </div>
                        <div className="flex items-center gap-3">
                          <span className={`px-2 py-1 text-xs rounded-full ${
                            cmd.statut === 'En production' ? 'bg-blue-300 text-blue-950 border border-blue-400' :
                            cmd.statut === 'En pr√©paration' ? 'bg-yellow-300 text-yellow-950 border border-yellow-400' :
                            'bg-gray-300 text-gray-950 border border-gray-400'
                          }`}>
                            {cmd.statut}
                          </span>
                          <Button size="sm">Voir d√©tails</Button>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </Card>
          </div>
        );
      };

      // Composant Liste des Recettes
      const RecetteList = ({ onSelect }) => {
        const filteredRecettes = mockData.recettes.filter(recette =>
          recette.nom.toLowerCase().includes(searchTerm.toLowerCase())
        );

        return (
          <div className="space-y-6">
            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
              <h1 className="text-2xl font-display font-bold text-gray-800">Recettes</h1>
              <div className="flex gap-3">
                <input
                  type="text"
                  placeholder="Rechercher..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-black/50 focus:border-transparent"
                />
                <Button onClick={() => { setModalType('recette'); setShowModal(true); }}>
                  Nouvelle recette
                </Button>
              </div>
            </div>

            <Card className="overflow-hidden">
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-300 border-b border-gray-400">
                    <tr>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Nom</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Rendement</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Co√ªt mati√®re</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Temps pr√©paration</th>
                      <th className="px-6 py-4 text-left text-sm font-display font-medium text-gray-600">Allerg√®nes</th>
                      <th className="px-6 py-4 text-right text-sm font-display font-medium text-gray-600">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {filteredRecettes.map((recette, i) => (
                      <tr
                        key={recette.id}
                        onClick={() => onSelect(recette.id)}
                        className="hover:bg-gray-100 cursor-pointer transition-colors animate-fade-in-up"
                        style={{ animationDelay: `${i * 50}ms` }}
                      >
                        <td className="px-6 py-4 text-gray-800 font-body">{recette.nom}</td>
                        <td className="px-6 py-4 text-gray-800">{recette.rendement} {recette.unite}</td>
                        <td className="px-6 py-4">
                          <span className="font-semibold text-gray-800">{recette.coutMatiere.toFixed(2)} $</span>
                        </td>
                        <td className="px-6 py-4 text-gray-800">{recette.tempsPrepMinutes} min</td>
                        <td className="px-6 py-4">
                          {recette.allergenes.length > 0 ? (
                            <div className="flex flex-wrap gap-1">
                              {recette.allergenes.slice(0, 3).map((allergene, idx) => (
                                <span key={idx} className="inline-block px-2 py-0.5 text-xs bg-orange-300 text-orange-950 border border-orange-400 rounded">
                                  {allergene}
                                </span>
                              ))}
                              {recette.allergenes.length > 3 && (
                                <span className="text-xs text-gray-700">+{recette.allergenes.length - 3}</span>
                              )}
                            </div>
                          ) : (
                            <span className="text-gray-700 text-sm">Aucun</span>
                          )}
                        </td>
                        <td className="px-6 py-4 text-right">
                          <button
                            onClick={(e) => { e.stopPropagation(); goToEdit('recette', recette.id); }}
                            className="text-gray-600 hover:text-gray-800 transition-colors"
                          >
                            Modifier
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </Card>
          </div>
        );
      };

      // Composant D√©tail Recette
      const RecetteDetail = ({ recetteId, onBack }) => {
        const recette = mockData.recettes.find(r => r.id === recetteId);
        if (!recette) return <div>Recette non trouv√©e</div>;

        // Simulated ingredients for the recipe
        const ingredients = [
          { nom: "Poulet grill√©", quantite: 2, unite: "kg", cout: 24.00 },
          { nom: "Pain", quantite: 20, unite: "tranches", cout: 3.50 },
          { nom: "Laitue", quantite: 1, unite: "kg", cout: 4.00 },
          { nom: "Tomates", quantite: 0.5, unite: "kg", cout: 2.00 },
          { nom: "Mayonnaise", quantite: 250, unite: "ml", cout: 1.50 },
        ];

        const coutTotal = ingredients.reduce((sum, ing) => sum + ing.cout, 0);
        const coutParPortion = coutTotal / recette.rendement;

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour aux recettes" />

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-3xl font-display font-bold text-gray-800">{recette.nom}</h1>
                <p className="text-lg text-gray-600">Rendement: {recette.rendement} {recette.unite}</p>
              </div>
              <div className="flex gap-3">
                <Button variant="secondary" onClick={() => goToEdit('recette', recetteId)}>Modifier</Button>
                <Button>Imprimer</Button>
                <Button variant="ghost">Supprimer</Button>
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">Co√ªts</h3>
                <dl className="space-y-3">
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Co√ªt mati√®re total</dt>
                    <dd className="text-2xl font-bold text-gray-800">{coutTotal.toFixed(2)} $</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Co√ªt par portion</dt>
                    <dd className="text-xl font-semibold text-gray-800">{coutParPortion.toFixed(2)} $</dd>
                  </div>
                </dl>
              </Card>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">Temps</h3>
                <dl className="space-y-3">
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Temps de pr√©paration</dt>
                    <dd className="text-2xl font-bold text-gray-800">{recette.tempsPrepMinutes} min</dd>
                  </div>
                  <div>
                    <dt className="text-sm text-gray-600 font-body">Temps par portion</dt>
                    <dd className="text-xl font-semibold text-gray-800">
                      {(recette.tempsPrepMinutes / recette.rendement).toFixed(1)} min
                    </dd>
                  </div>
                </dl>
              </Card>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">Allerg√®nes</h3>
                {recette.allergenes.length > 0 ? (
                  <div className="flex flex-wrap gap-2">
                    {recette.allergenes.map((allergene, idx) => (
                      <span key={idx} className="inline-block px-3 py-1 bg-orange-300 text-orange-950 border border-orange-400 rounded-lg">
                        {allergene}
                      </span>
                    ))}
                  </div>
                ) : (
                  <p className="text-gray-700">Aucun allerg√®ne d√©clar√©</p>
                )}
              </Card>
            </div>

            {/* Section des ingr√©dients */}
            <Card className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h3 className="font-display font-semibold text-gray-800">Ingr√©dients</h3>
                <Button size="sm" onClick={() => goToSubList('recette', recetteId, 'ingredients')}>
                  G√©rer les ingr√©dients
                </Button>
              </div>

              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="border-b border-gray-400">
                    <tr>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Ingr√©dient</th>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Quantit√©</th>
                      <th className="pb-3 text-right text-sm font-medium text-gray-600">Co√ªt</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {ingredients.map((ing, idx) => (
                      <tr key={idx} className="group">
                        <td className="py-3 text-gray-800">{ing.nom}</td>
                        <td className="py-3 text-gray-800">{ing.quantite} {ing.unite}</td>
                        <td className="py-3 text-right font-semibold text-gray-800">{ing.cout.toFixed(2)} $</td>
                      </tr>
                    ))}
                    <tr className="border-t-2 border-gray-600">
                      <td colSpan={2} className="pt-3 text-right font-semibold text-gray-800">Total:</td>
                      <td className="pt-3 text-right font-bold text-xl text-gray-800">{coutTotal.toFixed(2)} $</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </Card>

            {/* Section des √©tapes de pr√©paration */}
            <Card className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h3 className="font-display font-semibold text-gray-800">√âtapes de pr√©paration</h3>
                <Button size="sm" onClick={() => goToSubList('recette', recetteId, 'etapes')}>
                  G√©rer les √©tapes
                </Button>
              </div>

              <ol className="space-y-3">
                <li className="flex gap-3">
                  <span className="flex-shrink-0 w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-sm font-bold text-white">1</span>
                  <p className="text-gray-800 pt-1">Griller le poulet √† 180¬∞C pendant 20 minutes jusqu'√† ce qu'il soit bien dor√©.</p>
                </li>
                <li className="flex gap-3">
                  <span className="flex-shrink-0 w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-sm font-bold text-white">2</span>
                  <p className="text-gray-800 pt-1">Laisser refroidir et couper en tranches fines.</p>
                </li>
                <li className="flex gap-3">
                  <span className="flex-shrink-0 w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-sm font-bold text-white">3</span>
                  <p className="text-gray-800 pt-1">Pr√©parer les l√©gumes : laver la laitue, trancher les tomates.</p>
                </li>
                <li className="flex gap-3">
                  <span className="flex-shrink-0 w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-sm font-bold text-white">4</span>
                  <p className="text-gray-800 pt-1">Assembler les sandwichs en √©talant la mayonnaise, puis en ajoutant le poulet et les l√©gumes.</p>
                </li>
              </ol>
            </Card>
          </div>
        );
      };

      // Composant √âdition Recette
      const RecetteEdit = ({ recetteId, onBack }) => {
        const recette = mockData.recettes.find(r => r.id === recetteId);
        const [formData, setFormData] = React.useState({
          nom: recette?.nom || '',
          rendement: recette?.rendement || '',
          unite: recette?.unite || '',
          tempsPrepMinutes: recette?.tempsPrepMinutes || '',
          allergenes: recette?.allergenes.join(', ') || ''
        });

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label="Retour au d√©tail" />

            <h1 className="text-2xl font-display font-bold text-gray-800">
              {recetteId ? `Modifier ${recette?.nom}` : 'Nouvelle recette'}
            </h1>

            <Card className="p-6">
              <form className="space-y-6" onSubmit={(e) => {
                e.preventDefault();
                // Sauvegarder et retourner
                onBack();
              }}>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="md:col-span-2">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Nom de la recette
                    </label>
                    <input
                      type="text"
                      value={formData.nom}
                      onChange={(e) => setFormData({...formData, nom: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: Sandwich au poulet grill√©"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Rendement
                    </label>
                    <input
                      type="number"
                      value={formData.rendement}
                      onChange={(e) => setFormData({...formData, rendement: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="10"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Unit√©
                    </label>
                    <select
                      value={formData.unite}
                      onChange={(e) => setFormData({...formData, unite: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                    >
                      <option value="portions">portions</option>
                      <option value="unit√©s">unit√©s</option>
                      <option value="litres">litres</option>
                      <option value="kg">kg</option>
                    </select>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Temps de pr√©paration (minutes)
                    </label>
                    <input
                      type="number"
                      value={formData.tempsPrepMinutes}
                      onChange={(e) => setFormData({...formData, tempsPrepMinutes: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="30"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Allerg√®nes (s√©par√©s par des virgules)
                    </label>
                    <input
                      type="text"
                      value={formData.allergenes}
                      onChange={(e) => setFormData({...formData, allergenes: e.target.value})}
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Gluten, ≈íufs, Lait"
                    />
                  </div>
                </div>

                <div className="flex gap-3 pt-4 border-t border-gray-400">
                  <Button type="submit">Enregistrer</Button>
                  <Button type="button" variant="secondary" onClick={onBack}>Annuler</Button>
                </div>
              </form>
            </Card>
          </div>
        );
      };

      // Composant Liste des Ingr√©dients d'une recette
      const IngredientsList = ({ recetteId, onBack }) => {
        const recette = mockData.recettes.find(r => r.id === recetteId);
        const [ingredients, setIngredients] = React.useState([
          { id: 1, nom: "Poulet grill√©", quantite: 2, unite: "kg", cout: 24.00 },
          { id: 2, nom: "Pain", quantite: 20, unite: "tranches", cout: 3.50 },
          { id: 3, nom: "Laitue", quantite: 1, unite: "kg", cout: 4.00 },
          { id: 4, nom: "Tomates", quantite: 0.5, unite: "kg", cout: 2.00 },
          { id: 5, nom: "Mayonnaise", quantite: 250, unite: "ml", cout: 1.50 },
        ]);

        const coutTotal = ingredients.reduce((sum, ing) => sum + ing.cout, 0);

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label={`Retour √† ${recette?.nom}`} />

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-2xl font-display font-bold text-gray-800">Ingr√©dients</h1>
                <p className="text-gray-600">{recette?.nom}</p>
              </div>
              <Button>Ajouter un ingr√©dient</Button>
            </div>

            <Card className="overflow-hidden">
              <div className="p-4 border-b border-gray-400 bg-gray-300">
                <div className="flex items-center justify-between">
                  <span className="text-sm font-medium text-gray-600">Co√ªt total des ingr√©dients</span>
                  <span className="text-xl font-bold text-gray-800">{coutTotal.toFixed(2)} $</span>
                </div>
              </div>

              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-200 border-b border-gray-400">
                    <tr>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Ingr√©dient</th>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Quantit√©</th>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Co√ªt unitaire</th>
                      <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Co√ªt total</th>
                      <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {ingredients.map((ing) => (
                      <tr key={ing.id} className="hover:bg-gray-100 transition-colors">
                        <td className="px-6 py-4 text-gray-800">{ing.nom}</td>
                        <td className="px-6 py-4 text-gray-800">{ing.quantite} {ing.unite}</td>
                        <td className="px-6 py-4 text-gray-800">{(ing.cout / ing.quantite).toFixed(2)} $</td>
                        <td className="px-6 py-4 text-right font-semibold text-gray-800">{ing.cout.toFixed(2)} $</td>
                        <td className="px-6 py-4 text-right">
                          <div className="flex items-center justify-end gap-2">
                            <button className="text-gray-600 hover:text-gray-800 transition-colors">
                              Modifier
                            </button>
                            <button className="text-red-400 hover:text-red-300 transition-colors">
                              Retirer
                            </button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </Card>
          </div>
        );
      };

      // Composant Liste des √âtapes d'une recette
      const EtapesList = ({ recetteId, onBack }) => {
        const recette = mockData.recettes.find(r => r.id === recetteId);
        const [etapes, setEtapes] = React.useState([
          { id: 1, ordre: 1, description: "Griller le poulet √† 180¬∞C pendant 20 minutes jusqu'√† ce qu'il soit bien dor√©.", duree: 20 },
          { id: 2, ordre: 2, description: "Laisser refroidir et couper en tranches fines.", duree: 5 },
          { id: 3, ordre: 3, description: "Pr√©parer les l√©gumes : laver la laitue, trancher les tomates.", duree: 10 },
          { id: 4, ordre: 4, description: "Assembler les sandwichs en √©talant la mayonnaise, puis en ajoutant le poulet et les l√©gumes.", duree: 15 }
        ]);

        const dureeTotal = etapes.reduce((sum, etape) => sum + etape.duree, 0);

        return (
          <div className="space-y-6">
            <BackButton onClick={onBack} label={`Retour √† ${recette?.nom}`} />

            <div className="flex items-center justify-between">
              <div>
                <h1 className="text-2xl font-display font-bold text-gray-800">√âtapes de pr√©paration</h1>
                <p className="text-gray-600">{recette?.nom}</p>
              </div>
              <Button>Ajouter une √©tape</Button>
            </div>

            <Card className="p-6">
              <div className="mb-4 p-4 bg-gray-300 rounded-lg">
                <div className="flex items-center justify-between">
                  <span className="text-sm font-medium text-gray-600">Dur√©e totale de pr√©paration</span>
                  <span className="text-xl font-bold text-gray-800">{dureeTotal} minutes</span>
                </div>
              </div>

              <div className="space-y-4">
                {etapes.map((etape) => (
                  <div key={etape.id} className="flex gap-4 p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                    <div className="flex-shrink-0">
                      <div className="w-10 h-10 bg-black rounded-full flex items-center justify-center">
                        <span className="font-bold text-white">{etape.ordre}</span>
                      </div>
                    </div>
                    <div className="flex-1">
                      <p className="text-gray-800">{etape.description}</p>
                      <p className="text-sm text-gray-600 mt-1">Dur√©e: {etape.duree} min</p>
                    </div>
                    <div className="flex items-start gap-2">
                      <button className="text-gray-600 hover:text-gray-800 transition-colors">
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                      </button>
                      <button className="text-red-400 hover:text-red-300 transition-colors">
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                      </button>
                    </div>
                  </div>
                ))}
              </div>

              <div className="mt-6 flex justify-end">
                <Button variant="secondary">R√©organiser les √©tapes</Button>
              </div>
            </Card>
          </div>
        );
      };

      // Composant Punch pour check-in/check-out des employ√©s
      const Punch = () => {
        const [pin, setPin] = React.useState('');
        const [message, setMessage] = React.useState('');
        const [messageType, setMessageType] = React.useState(''); // 'success', 'error'
        const [currentEmployee, setCurrentEmployee] = React.useState(null);
        const [punchHistory, setPunchHistory] = React.useState(() => {
          // R√©cup√©rer l'historique depuis localStorage
          const saved = localStorage.getItem('punchHistory');
          return saved ? JSON.parse(saved) : [];
        });

        // Donn√©es mock√©es des employ√©s avec leurs PINs
        const employees = [
          { id: 1, nom: "Martin Leblanc", pin: "1234", role: "Chef cuisinier" },
          { id: 2, nom: "Julie Tremblay", pin: "5678", role: "Aide-cuisini√®re" },
          { id: 3, nom: "Fran√ßois Gagnon", pin: "9012", role: "Livreur" },
          { id: 4, nom: "Sophie Roy", pin: "3456", role: "Service traiteur" },
          { id: 5, nom: "Alexandre Dubois", pin: "7890", role: "Pr√©paration" }
        ];

        // Fonction pour g√©rer l'entr√©e du PIN
        const handlePinEntry = (digit) => {
          if (pin.length < 4) {
            const newPin = pin + digit;
            setPin(newPin);

            // V√©rifier automatiquement le PIN quand on atteint 4 chiffres
            if (newPin.length === 4) {
              const employee = employees.find(emp => emp.pin === newPin);
              if (employee) {
                setCurrentEmployee(employee);
                setMessage('');
                setMessageType('');
              } else {
                setMessage('PIN invalide');
                setMessageType('error');
                setTimeout(() => {
                  setPin('');
                  setMessage('');
                }, 1500);
              }
            }
          }
        };

        // Fonction pour effacer le PIN
        const clearPin = () => {
          setPin('');
          setCurrentEmployee(null);
          setMessage('');
          setMessageType('');
        };

        // Fonction pour g√©rer le punch (check-in ou check-out)
        const handlePunch = (type) => {
          if (!currentEmployee) return;

          const now = new Date();
          const punch = {
            id: Date.now(),
            employeeId: currentEmployee.id,
            employeeName: currentEmployee.nom,
            type: type,
            timestamp: now.toISOString(),
            date: now.toLocaleDateString('fr-CA'),
            time: now.toLocaleTimeString('fr-CA', { hour: '2-digit', minute: '2-digit' })
          };

          // Ajouter √† l'historique
          const newHistory = [punch, ...punchHistory];
          setPunchHistory(newHistory);
          localStorage.setItem('punchHistory', JSON.stringify(newHistory));

          // Afficher le message de confirmation
          setMessage(`${type === 'in' ? 'Check-in' : 'Check-out'} enregistr√© pour ${currentEmployee.nom}`);
          setMessageType('success');

          // R√©initialiser apr√®s 2 secondes
          setTimeout(() => {
            clearPin();
          }, 2000);
        };

        // Obtenir les punches du jour
        const today = new Date().toLocaleDateString('fr-CA');
        const todayPunches = punchHistory.filter(p => p.date === today);

        // Calculer le statut de chaque employ√©
        const employeeStatuses = employees.map(emp => {
          const empPunches = todayPunches.filter(p => p.employeeId === emp.id);
          const lastPunch = empPunches[0];
          return {
            ...emp,
            status: lastPunch ? (lastPunch.type === 'in' ? 'Pr√©sent' : 'Absent') : 'Absent',
            lastPunchTime: lastPunch ? lastPunch.time : null,
            lastPunchType: lastPunch ? lastPunch.type : null
          };
        });

        // Fonction pour v√©rifier si l'employ√© actuel a un shift en cours
        const hasActiveShift = () => {
          if (!currentEmployee) return false;
          const empPunches = todayPunches.filter(p => p.employeeId === currentEmployee.id);
          const lastPunch = empPunches[0];
          return lastPunch && lastPunch.type === 'in';
        };

        return (
          <div className="max-w-6xl mx-auto space-y-8">
            <div className="flex items-center justify-between">
              <h1 className="text-3xl font-display font-bold text-gray-800">Syst√®me de punch</h1>
              <div className="text-sm text-gray-600">
                {new Date().toLocaleDateString('fr-CA')} ‚Ä¢ {new Date().toLocaleTimeString('fr-CA', { hour: '2-digit', minute: '2-digit' })}
              </div>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
              {/* Panneau de punch */}
              <Card className="p-8">
                <h2 className="text-xl font-display font-semibold text-gray-800 mb-6 text-center">
                  {currentEmployee ? `Bienvenue, ${currentEmployee.nom}` : 'Entrez votre PIN'}
                </h2>

                {/* Affichage du PIN */}
                <div className="flex justify-center mb-8">
                  <div className="flex gap-3">
                    {[0, 1, 2, 3].map((index) => (
                      <div
                        key={index}
                        className="w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center text-2xl font-bold text-gray-800 border-2 border-gray-400"
                      >
                        {pin[index] ? '‚Ä¢' : ''}
                      </div>
                    ))}
                  </div>
                </div>

                {/* Message de feedback */}
                {message && (
                  <div className={`mb-6 p-4 rounded-lg text-center animate-fade-in ${
                    messageType === 'success' ? 'bg-green-300 text-green-950 border border-green-400' : 'bg-red-300 text-red-950 border border-red-400'
                  }`}>
                    {message}
                  </div>
                )}

                {!currentEmployee ? (
                  /* Clavier num√©rique */
                  <div className="grid grid-cols-3 gap-4 max-w-xs mx-auto">
                    {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((num) => (
                      <button
                        key={num}
                        onClick={() => handlePinEntry(num.toString())}
                        className="h-20 bg-gray-200 hover:bg-gray-300 rounded-xl text-2xl font-bold text-gray-800 transition-all hover:scale-105 active:scale-95"
                      >
                        {num}
                      </button>
                    ))}
                    <button
                      onClick={clearPin}
                      className="h-20 bg-gray-200 hover:bg-gray-300 rounded-xl text-gray-600 transition-all hover:scale-105 active:scale-95"
                    >
                      <svg className="w-8 h-8 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z" />
                      </svg>
                    </button>
                    <button
                      onClick={() => handlePinEntry('0')}
                      className="h-20 bg-gray-200 hover:bg-gray-300 rounded-xl text-2xl font-bold text-gray-800 transition-all hover:scale-105 active:scale-95"
                    >
                      0
                    </button>
                    <button
                      onClick={clearPin}
                      className="h-20 bg-gray-200 hover:bg-gray-300 rounded-xl text-gray-600 transition-all hover:scale-105 active:scale-95"
                    >
                      <svg className="w-8 h-8 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                      </svg>
                    </button>
                  </div>
                ) : (
                  /* Boutons Check-in/Check-out */
                  <div className="space-y-4">
                    {hasActiveShift() ? (
                      /* Si shift en cours, afficher seulement le bouton CHECK-OUT */
                      <>
                        <button
                          onClick={() => handlePunch('out')}
                          className="w-full h-32 bg-red-700 hover:bg-red-600 rounded-xl text-3xl font-bold text-white transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-4"
                        >
                          <svg className="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z" />
                          </svg>
                          CHECK-OUT
                        </button>
                        <p className="text-center text-sm text-gray-600 mt-2">
                          Shift en cours depuis {todayPunches.find(p => p.employeeId === currentEmployee.id && p.type === 'in')?.time}
                        </p>
                      </>
                    ) : (
                      /* Si pas de shift en cours, afficher les deux boutons */
                      <>
                        <button
                          onClick={() => handlePunch('in')}
                          className="w-full h-32 bg-green-700 hover:bg-green-600 rounded-xl text-3xl font-bold text-white transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-4"
                        >
                          <svg className="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          CHECK-IN
                        </button>
                        <button
                          onClick={() => handlePunch('out')}
                          className="w-full h-32 bg-red-700 hover:bg-red-600 rounded-xl text-3xl font-bold text-white transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-4"
                        >
                          <svg className="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z" />
                          </svg>
                          CHECK-OUT
                        </button>
                      </>
                    )}
                    <button
                      onClick={clearPin}
                      className="w-full py-3 bg-gray-200 hover:bg-gray-300 rounded-lg text-gray-600 transition-all"
                    >
                      Annuler
                    </button>
                  </div>
                )}
              </Card>

              {/* Panneau de statut des employ√©s */}
              <Card className="p-8">
                <h2 className="text-xl font-display font-semibold text-gray-800 mb-6">Pr√©sences du jour</h2>

                <div className="space-y-3">
                  {employeeStatuses.map((emp) => (
                    <div
                      key={emp.id}
                      className="p-4 bg-gray-100 rounded-lg flex items-center justify-between"
                    >
                      <div>
                        <p className="font-medium text-gray-800">{emp.nom}</p>
                        <p className="text-sm text-gray-600">{emp.role}</p>
                      </div>
                      <div className="text-right">
                        <span className={`inline-block px-3 py-1 rounded-full text-sm font-medium ${
                          emp.status === 'Pr√©sent' ? 'bg-green-300 text-green-950 border border-green-400' : 'bg-gray-300 text-gray-950 border border-gray-400'
                        }`}>
                          {emp.status}
                        </span>
                        {emp.lastPunchTime && (
                          <p className="text-xs text-gray-700 mt-1">
                            {emp.lastPunchType === 'in' ? 'Arriv√©e' : 'D√©part'}: {emp.lastPunchTime}
                          </p>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
              </Card>
            </div>

            {/* Historique des punches r√©cents */}
            <Card className="p-6">
              <h3 className="text-lg font-display font-semibold text-gray-800 mb-4">Activit√© r√©cente</h3>
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="border-b border-gray-400">
                    <tr>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Employ√©</th>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Type</th>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Date</th>
                      <th className="pb-3 text-left text-sm font-medium text-gray-600">Heure</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {todayPunches.slice(0, 10).map((punch) => (
                      <tr key={punch.id} className="animate-fade-in">
                        <td className="py-3 text-gray-800">{punch.employeeName}</td>
                        <td className="py-3">
                          <span className={`inline-block px-2 py-1 rounded-full text-xs font-medium ${
                            punch.type === 'in' ? 'bg-green-300 text-green-950 border border-green-400' : 'bg-red-300 text-red-950 border border-red-400'
                          }`}>
                            {punch.type === 'in' ? 'Check-in' : 'Check-out'}
                          </span>
                        </td>
                        <td className="py-3 text-gray-800">{punch.date}</td>
                        <td className="py-3 text-gray-800">{punch.time}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
                {todayPunches.length === 0 && (
                  <p className="text-center text-gray-700 py-8">Aucune activit√© aujourd'hui</p>
                )}
              </div>
            </Card>
          </div>
        );
      };

      // Composant Facturation
      const Facturation = () => {
        const [selectedClientId, setSelectedClientId] = React.useState(null);
        const [showCreateFacture, setShowCreateFacture] = React.useState(false);
        const [selectedFacture, setSelectedFacture] = React.useState(null);
        const [factures, setFactures] = React.useState([
          {
            id: 1,
            numero: "FAC-2024-001",
            clientId: 1,
            date: "2024-02-01",
            echeance: "2024-03-01",
            montantHT: 3200.00,
            taxes: 478.40,
            montantTotal: 3678.40,
            statut: "Pay√©e",
            commandes: ["CMD-2024-003"],
            paiements: [{ date: "2024-02-15", montant: 3678.40, methode: "Virement" }]
          },
          {
            id: 2,
            numero: "FAC-2024-002",
            clientId: 1,
            date: "2024-02-05",
            echeance: "2024-03-05",
            montantHT: 2450.00,
            taxes: 366.38,
            montantTotal: 2816.38,
            statut: "En attente",
            commandes: ["CMD-2024-001"],
            paiements: []
          },
          {
            id: 3,
            numero: "FAC-2024-003",
            clientId: 3,
            date: "2024-01-28",
            echeance: "2024-02-28",
            montantHT: 5600.00,
            taxes: 837.20,
            montantTotal: 6437.20,
            statut: "En retard",
            commandes: ["CMD-2024-004"],
            paiements: []
          },
          {
            id: 4,
            numero: "FAC-2024-004",
            clientId: 2,
            date: "2024-02-03",
            echeance: "2024-03-03",
            montantHT: 1890.00,
            taxes: 282.56,
            montantTotal: 2172.56,
            statut: "Envoy√©e",
            commandes: ["CMD-2024-002"],
            paiements: []
          }
        ]);

        const getClientName = (clientId) => {
          const client = mockData.clients.find(c => c.id === clientId);
          return client ? client.entreprise : 'Client inconnu';
        };

        const getStatutColor = (statut) => {
          switch (statut) {
            case 'Pay√©e': return 'text-green-950 bg-green-300 border border-green-400';
            case 'En attente': return 'text-yellow-950 bg-yellow-300 border border-yellow-400';
            case 'En retard': return 'text-red-950 bg-red-300 border border-red-400';
            case 'Envoy√©e': return 'text-blue-950 bg-blue-300 border border-blue-400';
            default: return 'text-gray-950 bg-gray-300 border border-gray-400';
          }
        };

        const calculateTotals = () => {
          const total = factures.reduce((sum, f) => sum + f.montantTotal, 0);
          const enAttente = factures.filter(f => f.statut === 'En attente' || f.statut === 'Envoy√©e')
            .reduce((sum, f) => sum + f.montantTotal, 0);
          const enRetard = factures.filter(f => f.statut === 'En retard')
            .reduce((sum, f) => sum + f.montantTotal, 0);
          const payees = factures.filter(f => f.statut === 'Pay√©e')
            .reduce((sum, f) => sum + f.montantTotal, 0);

          return { total, enAttente, enRetard, payees };
        };

        const totals = calculateTotals();

        // Vue d√©taill√©e d'une facture
        if (selectedFacture) {
          const facture = factures.find(f => f.id === selectedFacture);
          const client = mockData.clients.find(c => c.id === facture.clientId);
          const commandes = mockData.commandes.filter(c => facture.commandes.includes(c.numero));

          return (
            <div className="space-y-6">
              <BackButton onClick={() => setSelectedFacture(null)} label="Retour aux factures" />

              <div className="flex items-start justify-between">
                <div>
                  <h1 className="text-2xl font-display font-bold text-gray-800">
                    Facture {facture.numero}
                  </h1>
                  <p className="text-gray-600">{client.entreprise}</p>
                </div>
                <div className="flex gap-2">
                  <Button variant="secondary">
                    <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    T√©l√©charger PDF
                  </Button>
                  <Button>Envoyer par courriel</Button>
                </div>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Informations de la facture */}
                <Card className="p-6 lg:col-span-2">
                  <h3 className="font-display font-semibold text-gray-800 mb-4">D√©tails de la facture</h3>

                  <div className="grid grid-cols-2 gap-6 mb-6">
                    <div>
                      <p className="text-sm text-gray-600">Date de facturation</p>
                      <p className="font-medium text-gray-800">{facture.date}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Date d'√©ch√©ance</p>
                      <p className="font-medium text-gray-800">{facture.echeance}</p>
                    </div>
                  </div>

                  <div className="border-t border-gray-300 pt-6">
                    <h4 className="font-medium text-gray-800 mb-4">Commandes factur√©es</h4>
                    <div className="space-y-3">
                      {commandes.map(commande => (
                        <div key={commande.id} className="p-4 bg-gray-100 rounded-lg">
                          <div className="flex items-center justify-between">
                            <div>
                              <p className="font-medium text-gray-800">{commande.numero}</p>
                              <p className="text-sm text-gray-600">
                                {commande.items} articles - Livraison: {commande.livraison}
                              </p>
                            </div>
                            <p className="font-medium text-gray-800">{commande.montant.toFixed(2)} $</p>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  <div className="border-t border-gray-300 pt-6 mt-6">
                    <div className="space-y-2">
                      <div className="flex justify-between">
                        <p className="text-gray-600">Sous-total HT</p>
                        <p className="font-medium text-gray-800">{facture.montantHT.toFixed(2)} $</p>
                      </div>
                      <div className="flex justify-between">
                        <p className="text-gray-600">Taxes (TPS/TVQ)</p>
                        <p className="font-medium text-gray-800">{facture.taxes.toFixed(2)} $</p>
                      </div>
                      <div className="flex justify-between pt-2 border-t border-gray-300">
                        <p className="font-semibold text-gray-800">Total</p>
                        <p className="text-xl font-bold text-gray-800">{facture.montantTotal.toFixed(2)} $</p>
                      </div>
                    </div>
                  </div>
                </Card>

                {/* Statut et paiements */}
                <div className="space-y-6">
                  <Card className="p-6">
                    <h3 className="font-display font-semibold text-gray-800 mb-4">Statut</h3>
                    <div className="text-center">
                      <span className={`inline-block px-4 py-2 rounded-full text-sm font-medium ${getStatutColor(facture.statut)}`}>
                        {facture.statut}
                      </span>
                      {facture.statut === 'En retard' && (
                        <p className="mt-3 text-sm text-red-400">
                          En retard de {Math.floor((new Date() - new Date(facture.echeance)) / (1000 * 60 * 60 * 24))} jours
                        </p>
                      )}
                    </div>
                  </Card>

                  <Card className="p-6">
                    <h3 className="font-display font-semibold text-gray-800 mb-4">Informations client</h3>
                    <div className="space-y-3">
                      <div>
                        <p className="text-sm text-gray-600">Entreprise</p>
                        <p className="font-medium text-gray-800">{client.entreprise}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Contact</p>
                        <p className="font-medium text-gray-800">{client.nom}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Courriel</p>
                        <p className="font-medium text-gray-800">{client.email}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Limite de cr√©dit</p>
                        <p className="font-medium text-gray-800">{client.credit.toFixed(2)} $</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Solde d√ª</p>
                        <p className="font-medium text-red-400">{client.balance.toFixed(2)} $</p>
                      </div>
                    </div>
                  </Card>

                  {facture.paiements.length > 0 && (
                    <Card className="p-6">
                      <h3 className="font-display font-semibold text-gray-800 mb-4">Paiements re√ßus</h3>
                      <div className="space-y-3">
                        {facture.paiements.map((paiement, index) => (
                          <div key={index} className="p-3 bg-gray-100 rounded">
                            <div className="flex justify-between items-start">
                              <div>
                                <p className="text-sm text-gray-600">{paiement.date}</p>
                                <p className="text-xs text-gray-700">{paiement.methode}</p>
                              </div>
                              <p className="font-medium text-gray-800">{paiement.montant.toFixed(2)} $</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    </Card>
                  )}

                  {facture.statut !== 'Pay√©e' && (
                    <Button className="w-full">Enregistrer un paiement</Button>
                  )}
                </div>
              </div>
            </div>
          );
        }

        // Formulaire de cr√©ation de facture
        if (showCreateFacture) {
          const commandesNonFacturees = mockData.commandes.filter(c =>
            c.statut === 'Livr√©e' && !factures.some(f => f.commandes.includes(c.numero))
          );

          return (
            <div className="space-y-6">
              <BackButton onClick={() => setShowCreateFacture(false)} label="Retour aux factures" />

              <h1 className="text-2xl font-display font-bold text-gray-800">Nouvelle facture</h1>

              <Card className="p-6">
                <h3 className="font-display font-semibold text-gray-800 mb-4">S√©lectionner les commandes √† facturer</h3>

                {commandesNonFacturees.length === 0 ? (
                  <p className="text-gray-600 text-center py-8">Aucune commande livr√©e en attente de facturation</p>
                ) : (
                  <div className="space-y-3">
                    {commandesNonFacturees.map(commande => {
                      const client = mockData.clients.find(c => c.id === commande.clientId);
                      return (
                        <div key={commande.id} className="p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors cursor-pointer">
                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                              <input
                                type="checkbox"
                                id={`cmd-${commande.id}`}
                                className="w-4 h-4 text-black focus:ring-black border-gray-300 rounded"
                              />
                              <label htmlFor={`cmd-${commande.id}`} className="flex-1 cursor-pointer">
                                <p className="font-medium text-gray-800">{commande.numero}</p>
                                <p className="text-sm text-gray-600">
                                  {client.entreprise} - Livr√©e le {commande.livraison}
                                </p>
                              </label>
                            </div>
                            <p className="font-medium text-gray-800">{commande.montant.toFixed(2)} $</p>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}

                <div className="mt-6 flex justify-end gap-3">
                  <Button variant="secondary" onClick={() => setShowCreateFacture(false)}>
                    Annuler
                  </Button>
                  <Button disabled={commandesNonFacturees.length === 0}>
                    Cr√©er la facture
                  </Button>
                </div>
              </Card>
            </div>
          );
        }

        // Liste des factures
        return (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h1 className="text-2xl font-display font-bold text-gray-800">Facturation</h1>
              <Button onClick={() => setShowCreateFacture(true)}>
                Nouvelle facture
              </Button>
            </div>

            {/* Cartes de r√©sum√© */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Total en attente</p>
                    <p className="text-2xl font-bold text-gray-800">{totals.enAttente.toFixed(2)} $</p>
                  </div>
                  <div className="w-12 h-12 bg-yellow-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-yellow-400">‚è≥</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">En retard</p>
                    <p className="text-2xl font-bold text-red-400">{totals.enRetard.toFixed(2)} $</p>
                  </div>
                  <div className="w-12 h-12 bg-red-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-red-400">‚ö†Ô∏è</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Pay√©es ce mois</p>
                    <p className="text-2xl font-bold text-green-400">{totals.payees.toFixed(2)} $</p>
                  </div>
                  <div className="w-12 h-12 bg-green-900/20 rounded-lg flex items-center justify-center">
                    <span className="text-green-400">‚úì</span>
                  </div>
                </div>
              </Card>

              <Card className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Nb factures</p>
                    <p className="text-2xl font-bold text-gray-800">{factures.length}</p>
                  </div>
                  <div className="w-12 h-12 bg-gray-400 rounded-lg flex items-center justify-center">
                    <span className="text-white">üìÑ</span>
                  </div>
                </div>
              </Card>
            </div>

            {/* Filtres */}
            <Card className="p-4">
              <div className="flex flex-wrap gap-4">
                <select className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black">
                  <option value="">Tous les clients</option>
                  {mockData.clients.map(client => (
                    <option key={client.id} value={client.id}>{client.entreprise}</option>
                  ))}
                </select>
                <select className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black">
                  <option value="">Tous les statuts</option>
                  <option value="En attente">En attente</option>
                  <option value="Envoy√©e">Envoy√©e</option>
                  <option value="En retard">En retard</option>
                  <option value="Pay√©e">Pay√©e</option>
                </select>
                <input
                  type="month"
                  defaultValue="2024-02"
                  className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black"
                />
              </div>
            </Card>

            {/* Liste des factures */}
            <Card className="overflow-hidden">
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-200 border-b border-gray-400">
                    <tr>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Num√©ro</th>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Client</th>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Date</th>
                      <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">√âch√©ance</th>
                      <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Montant</th>
                      <th className="px-6 py-4 text-center text-sm font-medium text-gray-600">Statut</th>
                      <th className="px-6 py-4 text-center text-sm font-medium text-gray-600">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-700">
                    {factures.map((facture) => (
                      <tr key={facture.id} className="hover:bg-gray-100 transition-colors">
                        <td className="px-6 py-4 text-gray-800 font-medium">{facture.numero}</td>
                        <td className="px-6 py-4 text-gray-800">{getClientName(facture.clientId)}</td>
                        <td className="px-6 py-4 text-gray-800">{facture.date}</td>
                        <td className="px-6 py-4 text-gray-800">{facture.echeance}</td>
                        <td className="px-6 py-4 text-right text-gray-800 font-medium">
                          {facture.montantTotal.toFixed(2)} $
                        </td>
                        <td className="px-6 py-4 text-center">
                          <span className={`inline-block px-3 py-1 rounded-full text-xs font-medium ${getStatutColor(facture.statut)}`}>
                            {facture.statut}
                          </span>
                        </td>
                        <td className="px-6 py-4 text-center">
                          <div className="flex items-center justify-center gap-2">
                            <button
                              onClick={() => setSelectedFacture(facture.id)}
                              className="text-gray-600 hover:text-gray-800 transition-colors"
                            >
                              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                              </svg>
                            </button>
                            <button className="text-gray-600 hover:text-gray-800 transition-colors">
                              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                              </svg>
                            </button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </Card>
          </div>
        );
      };

      // Composant Inventaire
      const Inventaire = () => {
        const [articles, setArticles] = React.useState(mockData.inventaire);
        const [showAddArticle, setShowAddArticle] = React.useState(false);
        const [showReception, setShowReception] = React.useState(false);
        const [selectedArticle, setSelectedArticle] = React.useState(null);
        const [activeSubTab, setActiveSubTab] = React.useState('articles');
        const [mouvements, setMouvements] = React.useState([
          {
            id: 1,
            date: '2024-02-04 10:30',
            type: 'Entr√©e',
            article: 'Farine tout usage',
            quantite: 20,
            unite: 'kg',
            lot: 'LOT-2024-025',
            motif: 'R√©ception fournisseur',
            responsable: 'Marie Lavoie'
          },
          {
            id: 2,
            date: '2024-02-04 09:15',
            type: 'Sortie',
            article: 'Poulet frais',
            quantite: 5,
            unite: 'kg',
            lot: 'LOT-2024-022',
            motif: 'Production - Sandwichs poulet',
            responsable: 'Chef Pierre'
          },
          {
            id: 3,
            date: '2024-02-03 16:45',
            type: 'Ajustement',
            article: 'Tomates fra√Æches',
            quantite: -2,
            unite: 'kg',
            lot: 'LOT-2024-018',
            motif: 'Perte - produits ab√Æm√©s',
            responsable: 'Marie Lavoie'
          }
        ]);

        // Calculs pour les statistiques
        const articlesEnAlerte = articles.filter(a => a.stock <= a.seuil).length;
        const valeurtotale = articles.reduce((sum, a) => sum + (a.stock * 15), 0); // Prix moyen estim√©
        const lotsExpirantBientot = articles.filter(a => {
          const daysUntilExpiry = Math.floor((new Date(a.peremption) - new Date()) / (1000 * 60 * 60 * 24));
          return daysUntilExpiry <= 7 && daysUntilExpiry >= 0;
        }).length;

        // Fonction pour obtenir la couleur du statut
        const getStatutColor = (article) => {
          const daysUntilExpiry = Math.floor((new Date(article.peremption) - new Date()) / (1000 * 60 * 60 * 24));

          if (article.stock <= article.seuil) return 'text-red-950 bg-red-300 border border-red-400';
          if (daysUntilExpiry <= 3 && daysUntilExpiry >= 0) return 'text-orange-950 bg-orange-300 border border-orange-400';
          if (daysUntilExpiry <= 7 && daysUntilExpiry >= 0) return 'text-yellow-950 bg-yellow-300 border border-yellow-400';
          return 'text-green-950 bg-green-300 border border-green-400';
        };

        // Fonction pour obtenir le badge de statut
        const getStatutBadge = (article) => {
          const daysUntilExpiry = Math.floor((new Date(article.peremption) - new Date()) / (1000 * 60 * 60 * 24));

          if (article.stock <= article.seuil) return 'Stock bas';
          if (daysUntilExpiry < 0) return 'Expir√©';
          if (daysUntilExpiry === 0) return 'Expire aujourd\'hui';
          if (daysUntilExpiry <= 3) return `Expire dans ${daysUntilExpiry}j`;
          if (daysUntilExpiry <= 7) return 'Expiration proche';
          return 'OK';
        };

        // Composant pour la modal d'ajout d'article avec profondeur
        const AddArticleModal = () => (
          <div className="fixed inset-0 bg-black/50 inventory-modal-backdrop flex items-center justify-center z-50 p-4">
            <Card className="w-full max-w-2xl animate-scale-in transform perspective-1000 shadow-2xl" elevation="extra">
              <div className="p-6">
                <h2 className="text-xl font-display font-semibold text-gray-800 mb-6">Nouvel article</h2>
                <form className="space-y-4" onSubmit={(e) => { e.preventDefault(); setShowAddArticle(false); }}>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Code SKU</label>
                      <input
                        type="text"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="ING-006"
                        required
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Nom de l'article</label>
                      <input
                        type="text"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="Ex: Beurre non sal√©"
                        required
                      />
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Cat√©gorie</label>
                      <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50">
                        <option value="">S√©lectionner...</option>
                        <option value="produits-laitiers">Produits laitiers</option>
                        <option value="viandes">Viandes et volailles</option>
                        <option value="legumes">L√©gumes frais</option>
                        <option value="fruits">Fruits frais</option>
                        <option value="sec">Produits secs</option>
                        <option value="surgeles">Surgel√©s</option>
                        <option value="condiments">Condiments et sauces</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Fournisseur principal</label>
                      <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50">
                        <option value="">S√©lectionner...</option>
                        <option value="metro">Metro</option>
                        <option value="sysco">Sysco</option>
                        <option value="gfs">GFS</option>
                        <option value="local">Fournisseur local</option>
                      </select>
                    </div>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Unit√© de stock</label>
                      <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50">
                        <option value="kg">kg</option>
                        <option value="litres">litres</option>
                        <option value="unites">unit√©s</option>
                        <option value="boites">bo√Ætes</option>
                        <option value="sacs">sacs</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Stock actuel</label>
                      <input
                        type="number"
                        step="0.01"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="0"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Seuil d'alerte</label>
                      <input
                        type="number"
                        step="0.01"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="10"
                        required
                      />
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Emplacement de stockage</label>
                    <input
                      type="text"
                      className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                      placeholder="Ex: Frigo 1 - √âtag√®re 2"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">Allerg√®nes (s√©lectionner tous ceux qui s'appliquent)</label>
                    <div className="grid grid-cols-3 gap-2 mt-2">
                      {['Arachides', 'Noix', 'Lait', '≈íufs', 'Gluten', 'Soja', 'Poisson', 'Crustac√©s', 'S√©same'].map(allergene => (
                        <label key={allergene} className="flex items-center space-x-2">
                          <input type="checkbox" className="rounded text-black focus:ring-black" />
                          <span className="text-sm text-gray-800">{allergene}</span>
                        </label>
                      ))}
                    </div>
                  </div>

                  <div className="flex gap-3 pt-4">
                    <Button type="submit">Cr√©er l'article</Button>
                    <Button type="button" variant="secondary" onClick={() => setShowAddArticle(false)}>
                      Annuler
                    </Button>
                  </div>
                </form>
              </div>
            </Card>
          </div>
        );

        // Composant pour la modal de r√©ception avec profondeur
        const ReceptionModal = () => (
          <div className="fixed inset-0 bg-black/50 inventory-modal-backdrop flex items-center justify-center z-50 p-4">
            <Card className="w-full max-w-2xl animate-scale-in transform perspective-1000 shadow-2xl" elevation="extra">
              <div className="p-6">
                <h2 className="text-xl font-display font-semibold text-gray-800 mb-6">R√©ception de marchandise</h2>
                <form className="space-y-4" onSubmit={(e) => { e.preventDefault(); setShowReception(false); }}>
                  <div className="bg-yellow-900/20 border border-yellow-400/50 rounded-lg p-4 mb-4">
                    <p className="text-sm text-yellow-400 flex items-center">
                      <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                      </svg>
                      Important: V√©rifiez les temp√©ratures et l'√©tat des produits √† la r√©ception
                    </p>
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Article</label>
                      <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50" required>
                        <option value="">S√©lectionner...</option>
                        {articles.map(article => (
                          <option key={article.id} value={article.id}>
                            {article.nom} ({article.sku})
                          </option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Fournisseur</label>
                      <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50" required>
                        <option value="">S√©lectionner...</option>
                        <option value="metro">Metro</option>
                        <option value="sysco">Sysco</option>
                        <option value="gfs">GFS</option>
                        <option value="local">Fournisseur local</option>
                      </select>
                    </div>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Quantit√© re√ßue</label>
                      <input
                        type="number"
                        step="0.01"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="0"
                        required
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">N¬∞ de lot</label>
                      <input
                        type="text"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        placeholder="LOT-2024-026"
                        required
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Date de p√©remption</label>
                      <input
                        type="date"
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        required
                      />
                    </div>
                  </div>

                  <div className="space-y-4 border-t border-gray-700 pt-4">
                    <h3 className="font-medium text-gray-800">Contr√¥les HACCP</h3>

                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Temp√©rature √† la r√©ception (¬∞C)</label>
                        <input
                          type="number"
                          step="0.1"
                          className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                          placeholder="Ex: 4.0"
                          required
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">√âtat du produit</label>
                        <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50" required>
                          <option value="conforme">Conforme</option>
                          <option value="non-conforme">Non conforme</option>
                          <option value="accepte-reserve">Accept√© avec r√©serve</option>
                        </select>
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Notes / Observations</label>
                      <textarea
                        className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                        rows="3"
                        placeholder="Ex: Emballage l√©g√®rement endommag√© mais produit intact"
                      />
                    </div>
                  </div>

                  <div className="flex gap-3 pt-4">
                    <Button type="submit">Valider la r√©ception</Button>
                    <Button type="button" variant="secondary" onClick={() => setShowReception(false)}>
                      Annuler
                    </Button>
                  </div>
                </form>
              </div>
            </Card>
          </div>
        );

        // Vue d√©taill√©e d'un article
        if (selectedArticle) {
          const article = articles.find(a => a.id === selectedArticle);
          const articleMouvements = mouvements.filter(m => m.article === article.nom);

          return (
            <div className="space-y-6 animate-fade-in">
              <div className="flex items-center justify-between">
                <div className="flex items-center space-x-4">
                  <button
                    onClick={() => setSelectedArticle(null)}
                    className="text-gray-600 hover:text-gray-800 transition-colors"
                  >
                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                  </button>
                  <h1 className="text-2xl font-display font-bold text-gray-800">{article.nom}</h1>
                  <span className={`inline-block px-3 py-1 rounded-full text-sm font-medium ${getStatutColor(article)}`}>
                    {getStatutBadge(article)}
                  </span>
                </div>
                <div className="flex gap-3">
                  <Button variant="secondary">Modifier</Button>
                  <Button>Mouvements de stock</Button>
                </div>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {/* Informations g√©n√©rales */}
                <Card className="p-6">
                  <h3 className="font-display font-semibold text-gray-800 mb-4">Informations g√©n√©rales</h3>
                  <div className="space-y-3">
                    <div>
                      <p className="text-sm text-gray-600">Code SKU</p>
                      <p className="font-medium text-gray-800">{article.sku}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Emplacement</p>
                      <p className="font-medium text-gray-800">{article.emplacement}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Unit√© de mesure</p>
                      <p className="font-medium text-gray-800">{article.unite}</p>
                    </div>
                  </div>
                </Card>

                {/* Stock et seuils */}
                <Card className="p-6">
                  <h3 className="font-display font-semibold text-gray-800 mb-4">Stock</h3>
                  <div className="space-y-3">
                    <div>
                      <p className="text-sm text-gray-600">Stock actuel</p>
                      <p className="text-2xl font-bold text-gray-800">{article.stock} {article.unite}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Seuil d'alerte</p>
                      <p className="font-medium text-gray-800">{article.seuil} {article.unite}</p>
                    </div>
                    <div className="pt-2">
                      <div className="w-full bg-gray-700 rounded-full h-2">
                        <div
                          className={`h-2 rounded-full ${article.stock <= article.seuil ? 'bg-red-400' : 'bg-green-400'}`}
                          style={{width: `${Math.min((article.stock / (article.seuil * 2)) * 100, 100)}%`}}
                        />
                      </div>
                    </div>
                  </div>
                </Card>

                {/* Tra√ßabilit√© */}
                <Card className="p-6">
                  <h3 className="font-display font-semibold text-gray-800 mb-4">Tra√ßabilit√©</h3>
                  <div className="space-y-3">
                    <div>
                      <p className="text-sm text-gray-600">Lot actuel</p>
                      <p className="font-medium text-gray-800">{article.lot}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Date de p√©remption</p>
                      <p className="font-medium text-gray-800">{new Date(article.peremption).toLocaleDateString('fr-CA')}</p>
                    </div>
                    <div>
                      <p className="text-sm text-gray-600">Jours restants</p>
                      <p className={`font-medium ${Math.floor((new Date(article.peremption) - new Date()) / (1000 * 60 * 60 * 24)) <= 7 ? 'text-orange-400' : 'text-gray-800'}`}>
                        {Math.floor((new Date(article.peremption) - new Date()) / (1000 * 60 * 60 * 24))} jours
                      </p>
                    </div>
                  </div>
                </Card>
              </div>

              {/* Historique des mouvements */}
              <Card className="overflow-hidden">
                <div className="p-6 border-b border-gray-700">
                  <h3 className="font-display font-semibold text-gray-800">Historique des mouvements</h3>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead className="bg-gray-200 border-b border-gray-400">
                      <tr>
                        <th className="px-6 py-3 text-left text-sm font-medium text-gray-600">Date</th>
                        <th className="px-6 py-3 text-left text-sm font-medium text-gray-600">Type</th>
                        <th className="px-6 py-3 text-right text-sm font-medium text-gray-600">Quantit√©</th>
                        <th className="px-6 py-3 text-left text-sm font-medium text-gray-600">Lot</th>
                        <th className="px-6 py-3 text-left text-sm font-medium text-gray-600">Motif</th>
                        <th className="px-6 py-3 text-left text-sm font-medium text-gray-600">Responsable</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-700">
                      {articleMouvements.map((mouvement) => (
                        <tr key={mouvement.id} className="hover:bg-gray-100 transition-colors">
                          <td className="px-6 py-4 text-sm text-gray-800">{mouvement.date}</td>
                          <td className="px-6 py-4">
                            <span className={`inline-block px-2 py-1 rounded text-xs font-medium ${
                              mouvement.type === 'Entr√©e' ? 'bg-green-300 text-green-950 border border-green-400' :
                              mouvement.type === 'Sortie' ? 'bg-red-300 text-red-950 border border-red-400' :
                              'bg-yellow-300 text-yellow-950 border border-yellow-400'
                            }`}>
                              {mouvement.type}
                            </span>
                          </td>
                          <td className="px-6 py-4 text-right font-medium text-gray-800">
                            {mouvement.type === 'Entr√©e' ? '+' : ''}{mouvement.quantite} {mouvement.unite}
                          </td>
                          <td className="px-6 py-4 text-sm text-gray-800">{mouvement.lot}</td>
                          <td className="px-6 py-4 text-sm text-gray-800">{mouvement.motif}</td>
                          <td className="px-6 py-4 text-sm text-gray-800">{mouvement.responsable}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </Card>
            </div>
          );
        }

        // Vue principale de l'inventaire
        return (
          <div className="space-y-6 animate-fade-in">
            <div className="flex items-center justify-between">
              <h1 className="text-2xl font-display font-bold text-gray-800">Gestion de l'inventaire</h1>
              <div className="flex gap-3">
                <Button variant="secondary" onClick={() => setShowReception(true)}>
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                  </svg>
                  R√©ception
                </Button>
                <Button onClick={() => setShowAddArticle(true)}>
                  <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                  </svg>
                  Nouvel article
                </Button>
              </div>
            </div>

            {/* Statistiques avec profondeur am√©lior√©e */}
            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
              <Card className="inventory-stat-card p-4" elevation="high">
                <div className="flex items-center justify-between relative z-10">
                  <div>
                    <p className="text-sm text-gray-600 font-medium">Articles en stock</p>
                    <p className="text-2xl font-bold text-gray-800 mt-1">{articles.length}</p>
                  </div>
                  <div className="inventory-icon-container">
                    <div className="w-12 h-12 bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg flex items-center justify-center shadow-lg transform rotate-3 hover:rotate-0 transition-transform duration-300">
                      <span className="text-white text-2xl">üì¶</span>
                    </div>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-4" elevation="high">
                <div className="flex items-center justify-between relative z-10">
                  <div>
                    <p className="text-sm text-gray-600 font-medium">Alertes stock</p>
                    <p className="text-2xl font-bold text-red-400 mt-1">{articlesEnAlerte}</p>
                  </div>
                  <div className="inventory-icon-container">
                    <div className="w-12 h-12 bg-gradient-to-br from-red-400 to-red-500 rounded-lg flex items-center justify-center shadow-lg transform -rotate-3 hover:rotate-0 transition-transform duration-300">
                      <span className="text-white text-2xl">‚ö†Ô∏è</span>
                    </div>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-4" elevation="high">
                <div className="flex items-center justify-between relative z-10">
                  <div>
                    <p className="text-sm text-gray-600 font-medium">Lots expirant</p>
                    <p className="text-2xl font-bold text-orange-400 mt-1">{lotsExpirantBientot}</p>
                    <p className="text-xs text-gray-600 mt-1 font-medium">dans 7 jours</p>
                  </div>
                  <div className="inventory-icon-container">
                    <div className="w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-500 rounded-lg flex items-center justify-center shadow-lg transform rotate-3 hover:rotate-0 transition-transform duration-300">
                      <span className="text-white text-2xl">üìÖ</span>
                    </div>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-4" elevation="high">
                <div className="flex items-center justify-between relative z-10">
                  <div>
                    <p className="text-sm text-gray-600 font-medium">Valeur totale</p>
                    <p className="text-2xl font-bold text-gray-800 mt-1">{valeurtotale.toFixed(0)} $</p>
                  </div>
                  <div className="inventory-icon-container">
                    <div className="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center shadow-lg transform -rotate-3 hover:rotate-0 transition-transform duration-300">
                      <span className="text-white text-2xl">üí∞</span>
                    </div>
                  </div>
                </div>
              </Card>
            </div>

            {/* Sous-navigation avec profondeur */}
            <Card className="p-1" elevation="normal">
              <div className="flex space-x-1">
                {['articles', 'mouvements', 'commandes'].map(tab => (
                  <button
                    key={tab}
                    onClick={() => setActiveSubTab(tab)}
                    className={`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${
                      activeSubTab === tab
                        ? 'bg-gradient-to-r from-gray-800 to-gray-900 text-white shadow-lg transform scale-105'
                        : 'text-gray-600 hover:text-gray-800 hover:bg-gray-100 hover:shadow-md'
                    }`}
                  >
                    {tab.charAt(0).toUpperCase() + tab.slice(1)}
                  </button>
                ))}
              </div>
            </Card>

            {/* Contenu selon l'onglet actif */}
            {activeSubTab === 'articles' && (
              <>
                {/* Filtres avec profondeur */}
                <Card className="p-4" elevation="normal">
                  <div className="flex flex-wrap gap-4">
                    <input
                      type="text"
                      placeholder="Rechercher un article..."
                      className="flex-1 min-w-[200px] px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-800 shadow-inner focus:outline-none focus:ring-2 focus:ring-black focus:shadow-md transition-shadow duration-200"
                    />
                    <select className="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-800 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-black transition-shadow duration-200 cursor-pointer">
                      <option value="">Toutes les cat√©gories</option>
                      <option value="produits-laitiers">Produits laitiers</option>
                      <option value="viandes">Viandes et volailles</option>
                      <option value="legumes">L√©gumes frais</option>
                      <option value="fruits">Fruits frais</option>
                      <option value="sec">Produits secs</option>
                    </select>
                    <select className="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-800 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-black transition-shadow duration-200 cursor-pointer">
                      <option value="">Tous les statuts</option>
                      <option value="ok">Stock OK</option>
                      <option value="bas">Stock bas</option>
                      <option value="expire">Expire bient√¥t</option>
                    </select>
                  </div>
                </Card>

                {/* Liste des articles avec profondeur */}
                <Card className="overflow-hidden" elevation="high">
                  <div className="overflow-x-auto rounded-xl">
                    <table className="w-full">
                      <thead className="bg-gradient-to-r from-gray-100 to-gray-200 border-b border-gray-400 shadow-sm">
                        <tr>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">SKU</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Nom</th>
                          <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Stock</th>
                          <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Seuil</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Lot</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">P√©remption</th>
                          <th className="px-6 py-4 text-center text-sm font-medium text-gray-600">Statut</th>
                          <th className="px-6 py-4 text-center text-sm font-medium text-gray-600">Actions</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-300">
                        {articles.map((article) => (
                          <tr key={article.id} className="inventory-table-row hover:bg-gray-100 transition-all duration-200">
                            <td className="px-6 py-4 text-gray-800 font-medium">{article.sku}</td>
                            <td className="px-6 py-4 text-gray-800">{article.nom}</td>
                            <td className={`px-6 py-4 text-right font-medium ${article.stock <= article.seuil ? 'text-red-400' : 'text-gray-800'}`}>
                              {article.stock} {article.unite}
                            </td>
                            <td className="px-6 py-4 text-right text-gray-800">{article.seuil} {article.unite}</td>
                            <td className="px-6 py-4 text-gray-800">{article.lot}</td>
                            <td className="px-6 py-4 text-gray-800">{new Date(article.peremption).toLocaleDateString('fr-CA')}</td>
                            <td className="px-6 py-4 text-center">
                              <span className={`inline-block px-3 py-1 rounded-full text-xs font-medium inventory-badge shadow-md ${getStatutColor(article)}`}>
                                {getStatutBadge(article)}
                              </span>
                            </td>
                            <td className="px-6 py-4 text-center">
                              <button
                                onClick={() => setSelectedArticle(article.id)}
                                className="text-gray-600 hover:text-gray-800 transition-colors"
                              >
                                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                              </button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </Card>
              </>
            )}

            {activeSubTab === 'mouvements' && (
              <>
                {/* Filtres des mouvements */}
                <Card className="p-4">
                  <div className="flex flex-wrap gap-4">
                    <input
                      type="date"
                      defaultValue="2024-02-04"
                      className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black"
                    />
                    <select className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black">
                      <option value="">Tous les types</option>
                      <option value="entree">Entr√©es</option>
                      <option value="sortie">Sorties</option>
                      <option value="ajustement">Ajustements</option>
                    </select>
                    <select className="px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black">
                      <option value="">Tous les articles</option>
                      {articles.map(article => (
                        <option key={article.id} value={article.id}>{article.nom}</option>
                      ))}
                    </select>
                    <Button variant="secondary">
                      <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                      Exporter
                    </Button>
                  </div>
                </Card>

                {/* Liste des mouvements */}
                <Card className="overflow-hidden">
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-gray-200 border-b border-gray-400">
                        <tr>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Date/Heure</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Type</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Article</th>
                          <th className="px-6 py-4 text-right text-sm font-medium text-gray-600">Quantit√©</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Lot</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Motif</th>
                          <th className="px-6 py-4 text-left text-sm font-medium text-gray-600">Responsable</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-700">
                        {mouvements.map((mouvement) => (
                          <tr key={mouvement.id} className="hover:bg-gray-100 transition-colors">
                            <td className="px-6 py-4 text-gray-800">{mouvement.date}</td>
                            <td className="px-6 py-4">
                              <span className={`inline-block px-2 py-1 rounded text-xs font-medium ${
                                mouvement.type === 'Entr√©e' ? 'bg-green-300 text-green-950 border border-green-400' :
                                mouvement.type === 'Sortie' ? 'bg-red-300 text-red-950 border border-red-400' :
                                'bg-yellow-300 text-yellow-950 border border-yellow-400'
                              }`}>
                                {mouvement.type}
                              </span>
                            </td>
                            <td className="px-6 py-4 text-gray-800">{mouvement.article}</td>
                            <td className="px-6 py-4 text-right font-medium text-gray-800">
                              {mouvement.type === 'Entr√©e' ? '+' : ''}{mouvement.quantite} {mouvement.unite}
                            </td>
                            <td className="px-6 py-4 text-gray-800">{mouvement.lot}</td>
                            <td className="px-6 py-4 text-gray-800">{mouvement.motif}</td>
                            <td className="px-6 py-4 text-gray-800">{mouvement.responsable}</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </Card>
              </>
            )}

            {activeSubTab === 'commandes' && (
              <Card className="p-8 text-center">
                <svg className="w-16 h-16 mx-auto mb-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                </svg>
                <h3 className="text-lg font-semibold text-gray-800 mb-2">Commandes fournisseurs</h3>
                <p className="text-gray-600 mb-4">G√©rez vos commandes et r√©approvisionnements automatiques</p>
                <Button>Cr√©er une commande</Button>
              </Card>
            )}

            {/* Modals */}
            {showAddArticle && <AddArticleModal />}
            {showReception && <ReceptionModal />}
          </div>
        );
      };

      // Composant Soumissions
      const Soumissions = () => {
        const [soumissions, setSoumissions] = React.useState([
          {
            id: 1,
            numero: "SOU-2024-001",
            client: "ABC Inc.",
            clientId: 1,
            evenement: "Cocktail d'entreprise ABC Inc.",
            date: "2024-02-10",
            dateCreation: "2024-01-25",
            montant: 8500,
            statut: "Envoy√©e",
            version: 2,
            tauxConversion: 75,
            dernierContact: "2024-02-01"
          },
          {
            id: 2,
            numero: "SOU-2024-002",
            client: "Mariage Tremblay-Gagnon",
            clientId: 3,
            evenement: "Mariage Tremblay-Gagnon",
            date: "2024-06-15",
            dateCreation: "2024-01-28",
            montant: 25000,
            statut: "Accept√©e",
            version: 3,
            tauxConversion: 90,
            dernierContact: "2024-02-02"
          },
          {
            id: 3,
            numero: "SOU-2024-003",
            client: "Banque XYZ",
            clientId: 2,
            evenement: "Lunch corporatif printemps",
            date: "2024-04-20",
            dateCreation: "2024-02-01",
            montant: 3200,
            statut: "Brouillon",
            version: 1,
            tauxConversion: 0,
            dernierContact: null
          },
          {
            id: 4,
            numero: "SOU-2024-004",
            client: "√âpicerie Lavoie & Fils",
            clientId: 2,
            evenement: "Lancement nouveau produit",
            date: "2024-03-15",
            dateCreation: "2024-02-03",
            montant: 4500,
            statut: "Vue par client",
            version: 1,
            tauxConversion: 65,
            dernierContact: "2024-02-04"
          }
        ]);

        const [showCreateSoumission, setShowCreateSoumission] = React.useState(false);
        const [selectedSoumission, setSelectedSoumission] = React.useState(null);
        const [activeSubTab, setActiveSubTab] = React.useState('actives');
        const [searchTerm, setSearchTerm] = React.useState('');
        const [showVersionHistory, setShowVersionHistory] = React.useState(false);
        const [editMode, setEditMode] = React.useState(false);

        // Filtrer les soumissions
        const filteredSoumissions = soumissions.filter(s => {
          const matchesSearch = s.numero.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               s.client.toLowerCase().includes(searchTerm.toLowerCase()) ||
                               s.evenement.toLowerCase().includes(searchTerm.toLowerCase());

          if (activeSubTab === 'actives') {
            return matchesSearch && ['Brouillon', 'Envoy√©e', 'Vue par client'].includes(s.statut);
          } else if (activeSubTab === 'acceptees') {
            return matchesSearch && s.statut === 'Accept√©e';
          } else if (activeSubTab === 'expirees') {
            return matchesSearch && ['Expir√©e', 'Refus√©e'].includes(s.statut);
          }
          return matchesSearch;
        });

        // Statistiques
        const stats = {
          totalActives: soumissions.filter(s => ['Brouillon', 'Envoy√©e', 'Vue par client'].includes(s.statut)).length,
          tauxConversion: Math.round(soumissions.filter(s => s.statut === 'Accept√©e').length / soumissions.length * 100),
          valeurTotale: soumissions.filter(s => s.statut === 'Accept√©e').reduce((sum, s) => sum + s.montant, 0),
          enAttente: soumissions.filter(s => s.statut === 'Vue par client').length
        };

        const SoumissionForm = ({ soumission, onClose, onSave }) => {
          const [formData, setFormData] = React.useState({
            client: soumission?.client || '',
            clientId: soumission?.clientId || null,
            evenement: soumission?.evenement || '',
            date: soumission?.date || '',
            lieu: soumission?.lieu || '',
            convives: soumission?.convives || 50,
            items: soumission?.items || [],
            services: soumission?.services || [],
            montantTotal: soumission?.montant || 0
          });

          const [selectedItems, setSelectedItems] = React.useState([]);
          const [activeStep, setActiveStep] = React.useState(1);

          // Items de menu disponibles (depuis les produits mock√©s)
          const menuItems = mockData.produits.map(p => ({
            ...p,
            quantite: 0,
            prixTotal: 0
          }));

          const calculateTotal = () => {
            const itemsTotal = selectedItems.reduce((sum, item) => sum + (item.prix * item.quantite), 0);
            const servicesTotal = formData.services.reduce((sum, service) => sum + service.prix, 0);
            setFormData({...formData, montantTotal: itemsTotal + servicesTotal});
          };

          React.useEffect(() => {
            calculateTotal();
          }, [selectedItems, formData.services]);

          return (
            <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
              <Card className="w-full max-w-4xl max-h-[90vh] overflow-y-auto animate-scale-in">
                <div className="p-6">
                  <h2 className="text-xl font-display font-semibold text-gray-800 mb-6">
                    {soumission ? 'Modifier la soumission' : 'Nouvelle soumission'}
                  </h2>

                  {/* Steps indicator */}
                  <div className="flex items-center justify-between mb-8">
                    {[
                      { step: 1, label: 'Informations' },
                      { step: 2, label: 'Menu' },
                      { step: 3, label: 'Services' },
                      { step: 4, label: 'R√©vision' }
                    ].map(({ step, label }) => (
                      <div key={step} className="flex items-center">
                        <button
                          onClick={() => setActiveStep(step)}
                          className={`w-10 h-10 rounded-full flex items-center justify-center font-medium transition-colors ${
                            step === activeStep ? 'bg-black text-white' :
                            step < activeStep ? 'bg-green-600 text-white' :
                            'bg-gray-200 text-gray-600'
                          }`}
                        >
                          {step < activeStep ? '‚úì' : step}
                        </button>
                        <span className={`ml-2 text-sm ${step === activeStep ? 'font-semibold' : ''}`}>
                          {label}
                        </span>
                        {step < 4 && <div className="w-12 h-0.5 bg-gray-300 ml-4" />}
                      </div>
                    ))}
                  </div>

                  <form onSubmit={(e) => { e.preventDefault(); onSave(formData); }}>
                    {/* √âtape 1: Informations de base */}
                    {activeStep === 1 && (
                      <div className="space-y-4">
                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Client</label>
                            <select
                              className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                              value={formData.clientId}
                              onChange={(e) => {
                                const client = mockData.clients.find(c => c.id === parseInt(e.target.value));
                                setFormData({
                                  ...formData,
                                  clientId: parseInt(e.target.value),
                                  client: client ? `${client.nom} - ${client.entreprise}` : ''
                                });
                              }}
                              required
                            >
                              <option value="">S√©lectionner un client</option>
                              {mockData.clients.map(client => (
                                <option key={client.id} value={client.id}>
                                  {client.nom} - {client.entreprise}
                                </option>
                              ))}
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Date de l'√©v√©nement</label>
                            <input
                              type="date"
                              className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                              value={formData.date}
                              onChange={(e) => setFormData({...formData, date: e.target.value})}
                              required
                            />
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Nom de l'√©v√©nement</label>
                          <input
                            type="text"
                            className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                            value={formData.evenement}
                            onChange={(e) => setFormData({...formData, evenement: e.target.value})}
                            placeholder="Ex: Cocktail d'entreprise, Mariage, Lunch corporatif"
                            required
                          />
                        </div>
                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Lieu</label>
                            <input
                              type="text"
                              className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                              value={formData.lieu}
                              onChange={(e) => setFormData({...formData, lieu: e.target.value})}
                              placeholder="Ex: Centre-ville Montr√©al"
                            />
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Nombre de convives</label>
                            <input
                              type="number"
                              className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                              value={formData.convives}
                              onChange={(e) => setFormData({...formData, convives: parseInt(e.target.value)})}
                              min="1"
                              required
                            />
                          </div>
                        </div>
                      </div>
                    )}

                    {/* √âtape 2: S√©lection du menu */}
                    {activeStep === 2 && (
                      <div className="space-y-4">
                        <h3 className="font-medium text-gray-900">S√©lection des items du menu</h3>
                        <div className="border border-gray-200 rounded-lg overflow-hidden">
                          <table className="w-full">
                            <thead className="bg-gray-50">
                              <tr>
                                <th className="px-4 py-3 text-left text-sm font-medium text-gray-700">Item</th>
                                <th className="px-4 py-3 text-left text-sm font-medium text-gray-700">Prix unitaire</th>
                                <th className="px-4 py-3 text-left text-sm font-medium text-gray-700">Quantit√©</th>
                                <th className="px-4 py-3 text-left text-sm font-medium text-gray-700">Total</th>
                              </tr>
                            </thead>
                            <tbody className="divide-y divide-gray-200">
                              {menuItems.map((item) => {
                                const selectedItem = selectedItems.find(i => i.id === item.id);
                                const quantite = selectedItem?.quantite || 0;
                                return (
                                  <tr key={item.id} className="hover:bg-gray-50">
                                    <td className="px-4 py-3">
                                      <div>
                                        <p className="font-medium text-gray-900">{item.nom}</p>
                                        <p className="text-sm text-gray-500">{item.categorie}</p>
                                      </div>
                                    </td>
                                    <td className="px-4 py-3 text-gray-900">{item.prix}$ / {item.unite}</td>
                                    <td className="px-4 py-3">
                                      <input
                                        type="number"
                                        className="w-20 px-2 py-1 border border-gray-300 rounded"
                                        value={quantite}
                                        onChange={(e) => {
                                          const newQuantite = parseInt(e.target.value) || 0;
                                          if (newQuantite > 0) {
                                            const newSelectedItems = selectedItems.filter(i => i.id !== item.id);
                                            newSelectedItems.push({
                                              ...item,
                                              quantite: newQuantite,
                                              prixTotal: newQuantite * item.prix
                                            });
                                            setSelectedItems(newSelectedItems);
                                          } else {
                                            setSelectedItems(selectedItems.filter(i => i.id !== item.id));
                                          }
                                        }}
                                        min="0"
                                      />
                                    </td>
                                    <td className="px-4 py-3 font-medium text-gray-900">
                                      {(quantite * item.prix).toFixed(2)}$
                                    </td>
                                  </tr>
                                );
                              })}
                            </tbody>
                          </table>
                        </div>
                        <div className="flex justify-end">
                          <div className="text-lg font-medium text-gray-900">
                            Sous-total items: {selectedItems.reduce((sum, item) => sum + item.prixTotal, 0).toFixed(2)}$
                          </div>
                        </div>
                      </div>
                    )}

                    {/* √âtape 3: Services additionnels */}
                    {activeStep === 3 && (
                      <div className="space-y-4">
                        <h3 className="font-medium text-gray-900">Services additionnels</h3>
                        {[
                          { id: 1, nom: 'Service sur place', description: '2 serveurs pour 4h', prix: 320 },
                          { id: 2, nom: 'Livraison', description: 'Dans un rayon de 20km', prix: 75 },
                          { id: 3, nom: 'Location vaisselle', description: 'Assiettes, verres, ustensiles', prix: 150 },
                          { id: 4, nom: 'Nappes et d√©coration', description: 'Nappes blanches, centres de table', prix: 200 }
                        ].map(service => {
                          const isSelected = formData.services.find(s => s.id === service.id);
                          return (
                            <label key={service.id} className="flex items-start gap-3 p-4 rounded-lg bg-gray-50 hover:bg-gray-100 cursor-pointer">
                              <input
                                type="checkbox"
                                className="mt-1 w-4 h-4 text-blue-700"
                                checked={!!isSelected}
                                onChange={(e) => {
                                  if (e.target.checked) {
                                    setFormData({
                                      ...formData,
                                      services: [...formData.services, service]
                                    });
                                  } else {
                                    setFormData({
                                      ...formData,
                                      services: formData.services.filter(s => s.id !== service.id)
                                    });
                                  }
                                }}
                              />
                              <div className="flex-1">
                                <p className="font-medium text-gray-900">{service.nom}</p>
                                <p className="text-sm text-gray-600">{service.description}</p>
                              </div>
                              <span className="font-medium text-gray-900">{service.prix}$</span>
                            </label>
                          );
                        })}
                      </div>
                    )}

                    {/* √âtape 4: R√©vision et calcul final */}
                    {activeStep === 4 && (
                      <div className="space-y-6">
                        <h3 className="font-medium text-gray-900">R√©sum√© de la soumission</h3>

                        <Card className="p-4 bg-gray-50">
                          <h4 className="font-medium text-gray-900 mb-2">Informations de l'√©v√©nement</h4>
                          <div className="space-y-1 text-sm">
                            <p><span className="text-gray-600">Client:</span> {formData.client}</p>
                            <p><span className="text-gray-600">√âv√©nement:</span> {formData.evenement}</p>
                            <p><span className="text-gray-600">Date:</span> {new Date(formData.date).toLocaleDateString('fr-CA')}</p>
                            <p><span className="text-gray-600">Lieu:</span> {formData.lieu || 'Non sp√©cifi√©'}</p>
                            <p><span className="text-gray-600">Convives:</span> {formData.convives}</p>
                          </div>
                        </Card>

                        {selectedItems.length > 0 && (
                          <Card className="p-4 bg-gray-50">
                            <h4 className="font-medium text-gray-900 mb-2">Items du menu</h4>
                            <div className="space-y-2">
                              {selectedItems.map(item => (
                                <div key={item.id} className="flex justify-between text-sm">
                                  <span>{item.nom} x {item.quantite}</span>
                                  <span className="font-medium">{item.prixTotal.toFixed(2)}$</span>
                                </div>
                              ))}
                            </div>
                          </Card>
                        )}

                        {formData.services.length > 0 && (
                          <Card className="p-4 bg-gray-50">
                            <h4 className="font-medium text-gray-900 mb-2">Services additionnels</h4>
                            <div className="space-y-2">
                              {formData.services.map(service => (
                                <div key={service.id} className="flex justify-between text-sm">
                                  <span>{service.nom}</span>
                                  <span className="font-medium">{service.prix}$</span>
                                </div>
                              ))}
                            </div>
                          </Card>
                        )}

                        <Card className="p-4 bg-blue-50 border-blue-200">
                          <div className="flex justify-between items-center">
                            <span className="text-lg font-medium text-gray-900">Montant total:</span>
                            <span className="text-2xl font-bold text-blue-700">{formData.montantTotal.toFixed(2)}$</span>
                          </div>
                        </Card>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Notes additionnelles</label>
                          <textarea
                            className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                            rows="3"
                            placeholder="Informations suppl√©mentaires, restrictions alimentaires, demandes sp√©ciales..."
                          />
                        </div>
                      </div>
                    )}

                    <div className="flex justify-between gap-3 mt-8 pt-6 border-t">
                      <Button
                        type="button"
                        variant="secondary"
                        onClick={() => activeStep > 1 && setActiveStep(activeStep - 1)}
                        disabled={activeStep === 1}
                      >
                        Pr√©c√©dent
                      </Button>
                      <div className="flex gap-3">
                        <Button type="button" variant="secondary" onClick={onClose}>
                          Annuler
                        </Button>
                        {activeStep < 4 ? (
                          <Button
                            type="button"
                            onClick={() => setActiveStep(activeStep + 1)}
                          >
                            Suivant
                          </Button>
                        ) : (
                          <Button type="submit" className="bg-black hover:bg-gray-800 text-white">
                            Cr√©er la soumission
                          </Button>
                        )}
                      </div>
                    </div>
                  </form>
                </div>
              </Card>
            </div>
          );
        };

        // Vue d√©taill√©e d'une soumission
        const SoumissionDetail = ({ soumission, onBack, onEdit }) => {
          const [showEmailModal, setShowEmailModal] = React.useState(false);
          const [showConvertModal, setShowConvertModal] = React.useState(false);

          const versions = [
            { version: 1, date: '2024-01-25', modifiePar: 'Jean Tremblay', changements: 'Cr√©ation initiale', montant: 8000 },
            { version: 2, date: '2024-01-28', modifiePar: 'Marie Lavoie', changements: 'Ajout service traiteur', montant: 8500 }
          ];

          return (
            <div className="space-y-6">
              <div className="flex items-center justify-between">
                <BackButton onClick={onBack} />
                <div className="flex gap-3">
                  <Button
                    variant="secondary"
                    onClick={() => setShowEmailModal(true)}
                    className="bg-gray-200 hover:bg-gray-300 text-gray-900"
                  >
                    <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    Envoyer par email
                  </Button>
                  {soumission.statut === 'Accept√©e' && (
                    <Button
                      className="bg-green-600 hover:bg-green-700 text-white"
                      onClick={() => setShowConvertModal(true)}
                    >
                      <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                      Convertir en commande
                    </Button>
                  )}
                  <Button onClick={onEdit}>Modifier</Button>
                </div>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Informations principales */}
                <Card className="lg:col-span-2">
                  <div className="p-6">
                    <div className="flex items-start justify-between mb-6">
                      <div>
                        <h2 className="text-2xl font-display font-bold text-gray-800">{soumission.numero}</h2>
                        <p className="text-gray-600 mt-1">{soumission.evenement}</p>
                      </div>
                      <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                        soumission.statut === 'Accept√©e' ? 'bg-green-100 text-green-700' :
                        soumission.statut === 'Envoy√©e' ? 'bg-blue-100 text-blue-700' :
                        soumission.statut === 'Vue par client' ? 'bg-yellow-100 text-yellow-700' :
                        soumission.statut === 'Brouillon' ? 'bg-gray-100 text-gray-700' :
                        'bg-red-100 text-red-700'
                      }`}>
                        {soumission.statut}
                      </span>
                    </div>

                    <div className="grid grid-cols-2 gap-4 mb-6">
                      <div>
                        <p className="text-sm text-gray-600">Client</p>
                        <p className="font-medium text-gray-900">{soumission.client}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Date de l'√©v√©nement</p>
                        <p className="font-medium text-gray-900">{new Date(soumission.date).toLocaleDateString('fr-CA')}</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Montant total</p>
                        <p className="text-xl font-bold text-gray-900">{soumission.montant.toLocaleString()}$</p>
                      </div>
                      <div>
                        <p className="text-sm text-gray-600">Version actuelle</p>
                        <p className="font-medium text-gray-900">Version {soumission.version}</p>
                      </div>
                    </div>

                    {/* Timeline de suivi */}
                    <div className="border-t pt-6">
                      <h3 className="font-medium text-gray-900 mb-4">Suivi de la soumission</h3>
                      <div className="space-y-4">
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center">
                            <svg className="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                          </div>
                          <div>
                            <p className="font-medium text-gray-900">Soumission cr√©√©e</p>
                            <p className="text-sm text-gray-600">{new Date(soumission.dateCreation).toLocaleDateString('fr-CA')}</p>
                          </div>
                        </div>
                        {soumission.statut !== 'Brouillon' && (
                          <div className="flex items-start gap-3">
                            <div className="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                              <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                              </svg>
                            </div>
                            <div>
                              <p className="font-medium text-gray-900">Soumission envoy√©e</p>
                              <p className="text-sm text-gray-600">Il y a 3 jours</p>
                            </div>
                          </div>
                        )}
                        {['Vue par client', 'Accept√©e'].includes(soumission.statut) && (
                          <div className="flex items-start gap-3">
                            <div className="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center">
                              <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                              </svg>
                            </div>
                            <div>
                              <p className="font-medium text-gray-900">Vue par le client</p>
                              <p className="text-sm text-gray-600">Il y a 1 jour</p>
                            </div>
                          </div>
                        )}
                        {soumission.statut === 'Accept√©e' && (
                          <div className="flex items-start gap-3">
                            <div className="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center">
                              <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                              </svg>
                            </div>
                            <div>
                              <p className="font-medium text-gray-900">Soumission accept√©e</p>
                              <p className="text-sm text-gray-600">{soumission.dernierContact}</p>
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                </Card>

                {/* Actions et historique */}
                <div className="space-y-6">
                  <Card className="p-6">
                    <h3 className="font-medium text-gray-900 mb-4">Actions rapides</h3>
                    <div className="space-y-3">
                      <button className="w-full text-left px-4 py-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors flex items-center gap-3">
                        <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <span className="text-gray-900">T√©l√©charger PDF</span>
                      </button>
                      <button
                        onClick={() => setShowVersionHistory(true)}
                        className="w-full text-left px-4 py-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors flex items-center gap-3"
                      >
                        <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span className="text-gray-900">Historique des versions</span>
                      </button>
                      <button className="w-full text-left px-4 py-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors flex items-center gap-3">
                        <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                        </svg>
                        <span className="text-gray-900">Dupliquer</span>
                      </button>
                    </div>
                  </Card>

                  <Card className="p-6">
                    <h3 className="font-medium text-gray-900 mb-4">M√©triques</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between">
                        <span className="text-gray-600">Ouvertures email</span>
                        <span className="font-medium text-gray-900">3</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Temps pass√©</span>
                        <span className="font-medium text-gray-900">2h 15min</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-600">Taux de conversion</span>
                        <span className="font-medium text-gray-900">{soumission.tauxConversion}%</span>
                      </div>
                    </div>
                  </Card>
                </div>
              </div>

              {/* Modal historique versions */}
              {showVersionHistory && (
                <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                  <Card className="w-full max-w-2xl animate-scale-in">
                    <div className="p-6">
                      <h3 className="text-xl font-display font-semibold text-gray-800 mb-4">
                        Historique des versions
                      </h3>
                      <div className="space-y-4">
                        {versions.map((v, idx) => (
                          <div key={idx} className="p-4 rounded-lg bg-gray-50 flex items-start justify-between">
                            <div>
                              <p className="font-medium text-gray-900">Version {v.version}</p>
                              <p className="text-sm text-gray-600">{v.date} - {v.modifiePar}</p>
                              <p className="text-sm text-gray-700 mt-1">{v.changements}</p>
                            </div>
                            <div className="text-right">
                              <p className="font-medium text-gray-900">{v.montant}$</p>
                              <button className="text-sm text-blue-700 hover:underline mt-1">
                                Comparer
                              </button>
                            </div>
                          </div>
                        ))}
                      </div>
                      <div className="flex justify-end mt-6">
                        <Button variant="secondary" onClick={() => setShowVersionHistory(false)}>
                          Fermer
                        </Button>
                      </div>
                    </div>
                  </Card>
                </div>
              )}
            </div>
          );
        };

        // Vue principale
        if (selectedSoumission && !editMode) {
          return (
            <SoumissionDetail
              soumission={selectedSoumission}
              onBack={() => setSelectedSoumission(null)}
              onEdit={() => setEditMode(true)}
            />
          );
        }

        return (
          <div className="space-y-6">
            {/* En-t√™te avec statistiques */}
            <div className="flex items-center justify-between">
              <h1 className="text-2xl font-display font-bold text-gray-800">Soumissions</h1>
              <Button
                onClick={() => setShowCreateSoumission(true)}
                className="bg-black hover:bg-gray-800 text-white"
              >
                <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                </svg>
                Nouvelle soumission
              </Button>
            </div>

            {/* Cartes statistiques */}
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
              <Card className="inventory-stat-card p-6">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Actives</p>
                    <p className="text-2xl font-bold text-gray-900 mt-1">{stats.totalActives}</p>
                  </div>
                  <div className="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                    <svg className="w-6 h-6 text-blue-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-6">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Taux de conversion</p>
                    <p className="text-2xl font-bold text-green-600 mt-1">{stats.tauxConversion}%</p>
                  </div>
                  <div className="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                    <svg className="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-6">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">Valeur accept√©es</p>
                    <p className="text-2xl font-bold text-gray-900 mt-1">{stats.valeurTotale.toLocaleString()}$</p>
                  </div>
                  <div className="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                    <svg className="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                </div>
              </Card>

              <Card className="inventory-stat-card p-6">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm text-gray-600">En attente</p>
                    <p className="text-2xl font-bold text-yellow-600 mt-1">{stats.enAttente}</p>
                  </div>
                  <div className="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                    <svg className="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                </div>
              </Card>
            </div>

            {/* Onglets et filtres */}
            <Card>
              <div className="border-b border-gray-200">
                <nav className="flex gap-6 px-6" aria-label="Tabs">
                  {[
                    { id: 'actives', label: 'Actives', count: stats.totalActives },
                    { id: 'acceptees', label: 'Accept√©es', count: soumissions.filter(s => s.statut === 'Accept√©e').length },
                    { id: 'expirees', label: 'Expir√©es/Refus√©es', count: soumissions.filter(s => ['Expir√©e', 'Refus√©e'].includes(s.statut)).length }
                  ].map(tab => (
                    <button
                      key={tab.id}
                      onClick={() => setActiveSubTab(tab.id)}
                      className={`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${
                        activeSubTab === tab.id
                          ? 'border-black text-gray-900'
                          : 'border-transparent text-gray-500 hover:text-gray-700'
                      }`}
                    >
                      {tab.label}
                      {tab.count > 0 && (
                        <span className="ml-2 px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600">
                          {tab.count}
                        </span>
                      )}
                    </button>
                  ))}
                </nav>
              </div>

              <div className="p-6">
                {/* Barre de recherche */}
                <div className="mb-6">
                  <div className="relative">
                    <input
                      type="text"
                      placeholder="Rechercher par num√©ro, client ou √©v√©nement..."
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black/50"
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                    />
                    <svg
                      className="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                  </div>
                </div>

                {/* Liste des soumissions */}
                <div className="space-y-4">
                  {filteredSoumissions.map(soumission => (
                    <div
                      key={soumission.id}
                      onClick={() => setSelectedSoumission(soumission)}
                      className="p-4 rounded-lg border border-gray-200 hover:bg-gray-50 cursor-pointer transition-colors"
                    >
                      <div className="flex items-start justify-between">
                        <div className="flex-1">
                          <div className="flex items-center gap-4">
                            <h3 className="font-medium text-gray-900">{soumission.numero}</h3>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              soumission.statut === 'Accept√©e' ? 'bg-green-100 text-green-700' :
                              soumission.statut === 'Envoy√©e' ? 'bg-blue-100 text-blue-700' :
                              soumission.statut === 'Vue par client' ? 'bg-yellow-100 text-yellow-700' :
                              soumission.statut === 'Brouillon' ? 'bg-gray-100 text-gray-700' :
                              'bg-red-100 text-red-700'
                            }`}>
                              {soumission.statut}
                            </span>
                          </div>
                          <p className="text-sm text-gray-600 mt-1">{soumission.client}</p>
                          <p className="text-sm text-gray-700 mt-1 font-medium">{soumission.evenement}</p>
                        </div>
                        <div className="text-right">
                          <p className="text-lg font-bold text-gray-900">{soumission.montant.toLocaleString()}$</p>
                          <p className="text-sm text-gray-600 mt-1">
                            {new Date(soumission.date).toLocaleDateString('fr-CA')}
                          </p>
                        </div>
                      </div>
                      {soumission.statut === 'Vue par client' && soumission.dernierContact && (
                        <div className="mt-3 flex items-center gap-2 text-sm text-yellow-700">
                          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span>Derni√®re vue: {soumission.dernierContact}</span>
                        </div>
                      )}
                    </div>
                  ))}
                </div>
              </div>
            </Card>

            {/* Modal cr√©ation soumission */}
            {showCreateSoumission && (
              <SoumissionForm
                onClose={() => setShowCreateSoumission(false)}
                onSave={(data) => {
                  const newSoumission = {
                    id: soumissions.length + 1,
                    numero: `SOU-2024-00${soumissions.length + 1}`,
                    client: data.client,
                    clientId: data.clientId,
                    evenement: data.evenement,
                    date: data.date,
                    dateCreation: new Date().toISOString().split('T')[0],
                    montant: data.montantTotal,
                    statut: "Brouillon",
                    version: 1,
                    tauxConversion: 0,
                    dernierContact: null
                  };
                  setSoumissions([...soumissions, newSoumission]);
                  setShowCreateSoumission(false);
                }}
              />
            )}

            {/* Modal √©dition */}
            {editMode && selectedSoumission && (
              <SoumissionForm
                soumission={selectedSoumission}
                onClose={() => {
                  setEditMode(false);
                  setSelectedSoumission(null);
                }}
                onSave={(data) => {
                  setSoumissions(soumissions.map(s =>
                    s.id === selectedSoumission.id
                      ? {...s, ...data, version: s.version + 1}
                      : s
                  ));
                  setEditMode(false);
                  setSelectedSoumission(null);
                }}
              />
            )}
          </div>
        );
      };

      // Navigation et menu principal
      const menuItems = [
        { id: 'dashboard', label: 'Tableau de bord', icon: 'üìä' },
        { id: 'demandes', label: 'Demandes', icon: 'üìß' },
        { id: 'clients', label: 'Clients', icon: 'üë•' },
        { id: 'soumissions', label: 'Soumissions', icon: 'üíº' },
        { id: 'production', label: 'Production', icon: 'üë®‚Äçüç≥' },
        { id: 'recettes', label: 'Recettes', icon: 'üìù' },
        { id: 'inventaire', label: 'Inventaire', icon: 'üì¶' },
        { id: 'factures', label: 'Facturation', icon: 'üí∞' },
        { id: 'rapports', label: 'Rapports', icon: 'üìà' },
        { id: 'punch', label: 'Punch', icon: '‚è∞' }
      ];

      return (
        <div className="min-h-screen bg-gray-200">
          {/* Header avec logo - Design poli et moderne */}
          <header className={`bg-white transition-all duration-300 ${isScrolled ? 'scrolled' : ''}`}>
            <div className="px-4 sm:px-6 lg:px-8">
              <div className="flex items-center justify-between h-20 sm:h-24">
                {/* Logo et marque */}
                <div className="flex items-center space-x-5">
                  <div className="logo-container group">
                    <div className="relative">
                      <img
                        src="https://lebangard.com/favicon-192x192.png"
                        alt="Le Bangard Inc."
                        className="h-12 w-12 sm:h-14 sm:w-14 rounded-xl logo-glow object-contain relative z-10"
                        onError={(e) => { e.target.src = "https://lebangard.com/favicon-180x180.png"; }}
                      />
                      <div className="absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                    </div>
                  </div>
                  <div className="hidden sm:block">
                    <div className="flex items-center space-x-4">
                      <div>
                        <h1 className="text-2xl sm:text-3xl font-display font-bold text-gray-900 tracking-tight">
                          Le Bangard Inc.
                        </h1>
                        <p className="text-xs text-gray-700 mt-0.5 font-medium tracking-wide">GESTION INTELLIGENTE</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Titre centr√© pour mobile */}
                <div className="flex sm:hidden items-center flex-col">
                  <h1 className="text-xl font-display font-bold text-gray-900">Le Bangard</h1>
                </div>

                {/* Info et actions √† droite */}
                <div className="flex items-center space-x-4 lg:space-x-8">
                  {/* Quick actions */}
                  <div className="hidden lg:flex items-center space-x-2">
                    <button className="p-2 hover:bg-gray-100 rounded-lg transition-all duration-200 relative group">
                      <svg className="w-5 h-5 text-gray-600 group-hover:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                      </svg>
                      <span className="absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full animate-pulse"></span>
                    </button>
                    <button className="p-2 hover:bg-gray-100 rounded-lg transition-all duration-200 group">
                      <svg className="w-5 h-5 text-gray-600 group-hover:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                      </svg>
                    </button>
                  </div>



                  {/* Profile dropdown */}
                  <div className="relative group">
                    <button className="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-all duration-200">
                      <div className="w-9 h-9 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-white font-bold text-sm shadow-md">
                        A
                      </div>
                      <svg className="hidden lg:block w-4 h-4 text-gray-600 group-hover:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                      </svg>
                    </button>
                  </div>

                  {/* Bouton menu mobile */}
                  <button className="md:hidden p-2.5 rounded-lg hover:bg-gray-100 transition-all duration-200 menu-button">
                    <svg className="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2.5} d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                  </button>
                </div>
              </div>
            </div>

            {/* Ligne de s√©paration √©l√©gante */}
            <div className="h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent"></div>
          </header>

          <div className="flex">
            {/* Sidebar */}
            <aside className="hidden lg:block w-64 bg-gray-50 border-r border-gray-200 min-h-screen shadow-sm">
              <nav className="p-4 space-y-1">
                {menuItems.map((item) => (
                  <button
                    key={item.id}
                    onClick={() => {
                      setActiveTab(item.id);
                      setView({ screen: 'list', entityType: null, entityId: null, subEntityType: null, subEntityId: null });
                      setSearchTerm('');
                    }}
                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 font-body ${
                      activeTab === item.id
                        ? 'bg-blue-600 text-white shadow-md'
                        : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'
                    }`}
                  >
                    <span className="text-xl opacity-70">{item.icon}</span>
                    <span className="font-medium">{item.label}</span>
                  </button>
                ))}
              </nav>
            </aside>

            {/* Navigation mobile */}
            <nav className="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50">
              <div className="grid grid-cols-5 gap-1 p-2">
                {[menuItems[0], menuItems[2], menuItems[4], menuItems[5], menuItems[9]].map((item) => (
                  <button
                    key={item.id}
                    onClick={() => {
                      setActiveTab(item.id);
                      setView({ screen: 'list', entityType: null, entityId: null, subEntityType: null, subEntityId: null });
                      setSearchTerm('');
                    }}
                    className={`flex flex-col items-center gap-1 p-2 rounded-lg transition-colors ${
                      activeTab === item.id
                        ? 'bg-blue-600 text-white'
                        : 'text-gray-600'
                    }`}
                  >
                    <span className="text-xl">{item.icon}</span>
                    <span className="text-xs font-body">{item.label}</span>
                  </button>
                ))}
              </div>
            </nav>

            {/* Contenu principal */}
            <main className="flex-1 p-4 md:p-8 pb-20 lg:pb-8">
              <div className="container mx-auto max-w-7xl">
                {activeTab === 'dashboard' && <Dashboard />}

                {activeTab === 'demandes' && <Demandes />}

                {activeTab === 'clients' && (
                  <>
                    {view.screen === 'list' && (
                      <ClientList onSelect={(id) => goToDetail('client', id)} />
                    )}
                    {view.screen === 'detail' && view.entityType === 'client' && (
                      <ClientDetail
                        clientId={view.entityId}
                        onBack={() => goToList('client')}
                      />
                    )}
                    {view.screen === 'edit' && view.entityType === 'client' && (
                      <ClientEdit
                        clientId={view.entityId}
                        onBack={() => view.entityId ? goToDetail('client', view.entityId) : goToList('client')}
                      />
                    )}
                    {view.screen === 'sublist' && view.subEntityType === 'commande' && (
                      <CommandesList
                        clientId={view.entityId}
                        onBack={() => goToDetail('client', view.entityId)}
                        onSelect={(cmdId) => goToSubDetail('client', view.entityId, 'commande', cmdId)}
                      />
                    )}
                    {view.screen === 'subdetail' && view.subEntityType === 'commande' && (
                      <CommandeDetail
                        commandeId={view.subEntityId}
                        onBack={() => goToSubList('client', view.entityId, 'commande')}
                        onEdit={() => goToSubEdit('client', view.entityId, 'commande', view.subEntityId)}
                      />
                    )}
                    {view.screen === 'subedit' && view.subEntityType === 'commande' && (
                      <CommandeEdit
                        commandeId={view.subEntityId}
                        onBack={() => goToSubDetail('client', view.entityId, 'commande', view.subEntityId)}
                      />
                    )}
                  </>
                )}

                {activeTab === 'production' && <Production />}

                {activeTab === 'recettes' && (
                  <>
                    {view.screen === 'list' && (
                      <RecetteList onSelect={(id) => goToDetail('recette', id)} />
                    )}
                    {view.screen === 'detail' && view.entityType === 'recette' && (
                      <RecetteDetail
                        recetteId={view.entityId}
                        onBack={() => goToList('recette')}
                      />
                    )}
                    {view.screen === 'edit' && view.entityType === 'recette' && (
                      <RecetteEdit
                        recetteId={view.entityId}
                        onBack={() => view.entityId ? goToDetail('recette', view.entityId) : goToList('recette')}
                      />
                    )}
                    {view.screen === 'sublist' && view.subEntityType === 'ingredients' && (
                      <IngredientsList
                        recetteId={view.entityId}
                        onBack={() => goToDetail('recette', view.entityId)}
                      />
                    )}
                    {view.screen === 'sublist' && view.subEntityType === 'etapes' && (
                      <EtapesList
                        recetteId={view.entityId}
                        onBack={() => goToDetail('recette', view.entityId)}
                      />
                    )}
                  </>
                )}

                {activeTab === 'punch' && <Punch />}

                {activeTab === 'factures' && <Facturation />}

                {activeTab === 'inventaire' && <Inventaire />}

                {activeTab === 'soumissions' && <Soumissions />}

                {/* Autres onglets √† impl√©menter */}
                {['rapports'].includes(activeTab) && (
                  <div className="space-y-6">
                    <h1 className="text-2xl font-display font-bold text-gray-800 capitalize">{activeTab}</h1>
                    <Card className="p-8 text-center">
                      <p className="text-gray-600">Module {activeTab} - En d√©veloppement</p>
                    </Card>
                  </div>
                )}
              </div>
            </main>
          </div>

          {/* Modal exemple */}
          {showModal && (
            <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
              <Card className="w-full max-w-md animate-scale-in">
                <div className="p-6">
                  <h2 className="text-xl font-display font-semibold text-gray-800 mb-4">
                    {modalType === 'recette' ? 'Nouvelle recette' : 'Nouveau client'}
                  </h2>
                  <form className="space-y-4" onSubmit={(e) => { e.preventDefault(); setShowModal(false); }}>
                    {modalType === 'client' ? (
                      <>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Nom</label>
                          <input
                            type="text"
                            className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                            placeholder="Jean Tremblay"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Entreprise</label>
                          <input
                            type="text"
                            className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                            placeholder="Restaurant ABC"
                          />
                        </div>
                      </>
                    ) : (
                      <>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Nom de la recette</label>
                          <input
                            type="text"
                            className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                            placeholder="Ex: Plateau de sandwichs vari√©s"
                          />
                        </div>
                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Rendement</label>
                            <input
                              type="number"
                              className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50"
                              placeholder="10"
                            />
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">Unit√©</label>
                            <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50">
                              <option value="portions">portions</option>
                              <option value="unit√©s">unit√©s</option>
                              <option value="litres">litres</option>
                              <option value="kg">kg</option>
                            </select>
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-1">Cat√©gorie</label>
                          <select className="w-full px-4 py-2 bg-white border border-gray-400 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-black/50">
                            <option value="">S√©lectionner une cat√©gorie</option>
                            <option value="Sandwichs">Sandwichs</option>
                            <option value="Salades">Salades</option>
                            <option value="Wraps">Wraps</option>
                            <option value="Plateaux">Plateaux</option>
                            <option value="Soupes">Soupes</option>
                            <option value="Desserts">Desserts</option>
                            <option value="Plats chauds">Plats chauds</option>
                            <option value="Bouch√©es">Bouch√©es</option>
                          </select>
                        </div>
                      </>
                    )}
                    <div className="flex gap-3 pt-4">
                      <Button type="submit">Cr√©er</Button>
                      <Button type="button" variant="secondary" onClick={() => setShowModal(false)}>
                        Annuler
                      </Button>
                    </div>
                  </form>
                </div>
              </Card>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>